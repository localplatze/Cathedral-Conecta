(()=>{var e={35358:(e,t,o)=>{var a={"./af":34871,"./af.js":34871,"./ar":23939,"./ar-dz":17990,"./ar-dz.js":17990,"./ar-kw":46646,"./ar-kw.js":46646,"./ar-ly":99755,"./ar-ly.js":99755,"./ar-ma":19234,"./ar-ma.js":19234,"./ar-ps":66777,"./ar-ps.js":66777,"./ar-sa":62184,"./ar-sa.js":62184,"./ar-tn":63962,"./ar-tn.js":63962,"./ar.js":23939,"./az":41067,"./az.js":41067,"./be":89645,"./be.js":89645,"./bg":30155,"./bg.js":30155,"./bm":44229,"./bm.js":44229,"./bn":14492,"./bn-bd":59647,"./bn-bd.js":59647,"./bn.js":14492,"./bo":53603,"./bo.js":53603,"./br":62856,"./br.js":62856,"./bs":97471,"./bs.js":97471,"./ca":9608,"./ca.js":9608,"./cs":90946,"./cs.js":90946,"./cv":20045,"./cv.js":20045,"./cy":2416,"./cy.js":2416,"./da":6571,"./da.js":6571,"./de":60623,"./de-at":77421,"./de-at.js":77421,"./de-ch":76883,"./de-ch.js":76883,"./de.js":60623,"./dv":32402,"./dv.js":32402,"./el":20973,"./el.js":20973,"./en-au":6898,"./en-au.js":6898,"./en-ca":17824,"./en-ca.js":17824,"./en-gb":16285,"./en-gb.js":16285,"./en-ie":37706,"./en-ie.js":37706,"./en-il":24193,"./en-il.js":24193,"./en-in":28671,"./en-in.js":28671,"./en-nz":46532,"./en-nz.js":46532,"./en-sg":67046,"./en-sg.js":67046,"./eo":96388,"./eo.js":96388,"./es":90688,"./es-do":42180,"./es-do.js":42180,"./es-mx":37012,"./es-mx.js":37012,"./es-us":84333,"./es-us.js":84333,"./es.js":90688,"./et":30837,"./et.js":30837,"./eu":21878,"./eu.js":21878,"./fa":61237,"./fa.js":61237,"./fi":20637,"./fi.js":20637,"./fil":86677,"./fil.js":86677,"./fo":16671,"./fo.js":16671,"./fr":10396,"./fr-ca":23821,"./fr-ca.js":23821,"./fr-ch":10662,"./fr-ch.js":10662,"./fr.js":10396,"./fy":51373,"./fy.js":51373,"./ga":85084,"./ga.js":85084,"./gd":90055,"./gd.js":90055,"./gl":54255,"./gl.js":54255,"./gom-deva":10410,"./gom-deva.js":10410,"./gom-latn":41717,"./gom-latn.js":41717,"./gu":18528,"./gu.js":18528,"./he":35643,"./he.js":35643,"./hi":47703,"./hi.js":47703,"./hr":10466,"./hr.js":10466,"./hu":53899,"./hu.js":53899,"./hy-am":3902,"./hy-am.js":3902,"./id":24913,"./id.js":24913,"./is":66836,"./is.js":66836,"./it":94433,"./it-ch":52829,"./it-ch.js":52829,"./it.js":94433,"./ja":64873,"./ja.js":64873,"./jv":20364,"./jv.js":20364,"./ka":14432,"./ka.js":14432,"./kk":45234,"./kk.js":45234,"./km":51092,"./km.js":51092,"./kn":65565,"./kn.js":65565,"./ko":39294,"./ko.js":39294,"./ku":20636,"./ku-kmr":75323,"./ku-kmr.js":75323,"./ku.js":20636,"./ky":29528,"./ky.js":29528,"./lb":20646,"./lb.js":20646,"./lo":32945,"./lo.js":32945,"./lt":3520,"./lt.js":3520,"./lv":8138,"./lv.js":8138,"./me":23550,"./me.js":23550,"./mi":54890,"./mi.js":54890,"./mk":50272,"./mk.js":50272,"./ml":74069,"./ml.js":74069,"./mn":58579,"./mn.js":58579,"./mr":57711,"./mr.js":57711,"./ms":23352,"./ms-my":86323,"./ms-my.js":86323,"./ms.js":23352,"./mt":64205,"./mt.js":64205,"./my":24474,"./my.js":24474,"./nb":14308,"./nb.js":14308,"./ne":94961,"./ne.js":94961,"./nl":99162,"./nl-be":65310,"./nl-be.js":65310,"./nl.js":99162,"./nn":61840,"./nn.js":61840,"./oc-lnc":78652,"./oc-lnc.js":78652,"./pa-in":20627,"./pa-in.js":20627,"./pl":46516,"./pl.js":46516,"./pt":99708,"./pt-br":80621,"./pt-br.js":80621,"./pt.js":99708,"./ro":54003,"./ro.js":54003,"./ru":59629,"./ru.js":59629,"./sd":15403,"./sd.js":15403,"./se":9732,"./se.js":9732,"./si":40912,"./si.js":40912,"./sk":94586,"./sk.js":94586,"./sl":98275,"./sl.js":98275,"./sq":65e3,"./sq.js":65e3,"./sr":95137,"./sr-cyrl":3424,"./sr-cyrl.js":3424,"./sr.js":95137,"./ss":41234,"./ss.js":41234,"./sv":61565,"./sv.js":61565,"./sw":11998,"./sw.js":11998,"./ta":27547,"./ta.js":27547,"./te":46367,"./te.js":46367,"./tet":94595,"./tet.js":94595,"./tg":41889,"./tg.js":41889,"./th":50988,"./th.js":50988,"./tk":57685,"./tk.js":57685,"./tl-ph":87149,"./tl-ph.js":87149,"./tlh":1658,"./tlh.js":1658,"./tr":12526,"./tr.js":12526,"./tzl":57504,"./tzl.js":57504,"./tzm":47223,"./tzm-latn":88129,"./tzm-latn.js":88129,"./tzm.js":47223,"./ug-cn":45888,"./ug-cn.js":45888,"./uk":83944,"./uk.js":83944,"./ur":903,"./ur.js":903,"./uz":87887,"./uz-latn":38617,"./uz-latn.js":38617,"./uz.js":87887,"./vi":23117,"./vi.js":23117,"./x-pseudo":83869,"./x-pseudo.js":83869,"./yo":42176,"./yo.js":42176,"./zh-cn":82346,"./zh-cn.js":82346,"./zh-hk":19590,"./zh-hk.js":19590,"./zh-mo":79451,"./zh-mo.js":79451,"./zh-tw":39822,"./zh-tw.js":39822};function n(e){var t=r(e);return o(t)}function r(e){if(!o.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=r,e.exports=n,n.id=35358},64192:(e,t,o)=>{"use strict";var a=o(53314),n=o(314),r=o(75147),l=o(37317),i=o(21045),s=o(11309),d=o(59517);const c=(0,i.initializeApp)({apiKey:"AIzaSyBd0eQg2SORLk0YyTbqCgWvnkBv8WycsA4",authDomain:"cathedralconecta.firebaseapp.com",databaseURL:"https://cathedralconecta-default-rtdb.firebaseio.com",projectId:"cathedralconecta",storageBucket:"cathedralconecta.firebasestorage.app",messagingSenderId:"607866866368",appId:"1:607866866368:web:09c800f276ae8a6b7e7b25",measurementId:"G-2TGNQWCQY5"}),u=(0,r.initializeAuth)(c,{persistence:(0,r.getReactNativePersistence)(d.default)}),f=(0,l.getDatabase)(c),h=(0,s.getStorage)(c);var g=o(67730);const m=(0,n.createContext)(),p=({children:e})=>{const[t,o]=(0,n.useState)(null),[a,i]=(0,n.useState)(null),[s,c]=(0,n.useState)(!0);(0,n.useEffect)((()=>(0,r.onAuthStateChanged)(u,(async e=>{c(!0),e?(o(e),await h(e.uid,e.email)):(o(null),i(null),await d.default.removeItem("appUserData")),c(!1)}))),[]);const h=async(e,t)=>{try{const o=(0,l.ref)(f,`users/${e}`),a=await(0,l.get)(o);if(a.exists()){const o=a.val(),n=Object.assign({uid:e,email:t},o);i(n),await d.default.setItem("appUserData",JSON.stringify(n))}else{console.warn("Dados do usu\xe1rio n\xe3o encontrados no Realtime Database para UID:",e);const o={uid:e,email:t,name:u.currentUser?.displayName||"Usu\xe1rio",role:"unknown",isAdmin:!1};i(o),await d.default.setItem("appUserData",JSON.stringify(o))}}catch(o){console.error("Erro ao buscar/salvar dados do usu\xe1rio:",o),i(null),await d.default.removeItem("appUserData")}};return(0,g.jsx)(m.Provider,{value:{user:t,userData:a,isLoadingAuth:s,logout:async()=>{c(!0);try{await(0,r.signOut)(u)}catch(e){console.error("Erro ao fazer logout:",e),Alert.alert("Erro","N\xe3o foi poss\xedvel fazer logout.")}},fetchAndSetUserData:h},children:e})},x=()=>(0,n.useContext)(m);var y=o(3950),j=o(20834),C=o(44485),b=o(32535),F=o(67137),v=o(32412),S=o(73151),T=o(69772),w=o(50607),B=o(98561),D=o(8798),z=o(14790),k=o(59371),A=o(83163),E=o(90343),I=o(92310);const P=({navigation:e})=>{const[t,a]=(0,n.useState)(""),[l,i]=(0,n.useState)(""),[s,d]=(0,n.useState)(!1),[c,f]=(0,n.useState)(!1),{fetchAndSetUserData:h}=x();return(0,g.jsxs)(B.default,{style:R.container,children:[(0,g.jsx)(k.default,{backgroundColor:"#1D854C",barStyle:"light-content"}),(0,g.jsx)(A.default,{behavior:"height",style:{flex:1},children:(0,g.jsxs)(w.default,{contentContainerStyle:{flexGrow:1},children:[(0,g.jsx)(C.default,{style:R.header,children:(0,g.jsx)(b.default,{style:R.headerTitle,children:"Cathedral Conecta"})}),(0,g.jsxs)(C.default,{style:R.content,children:[(0,g.jsx)(T.default,{style:R.logo,source:o(67847),resizeMode:"contain"}),(0,g.jsxs)(C.default,{style:R.formContainer,children:[(0,g.jsxs)(C.default,{style:R.inputWrapper,children:[(0,g.jsx)(E.default,{name:"person-outline",size:22,color:"#4A5568",style:R.inputIcon}),(0,g.jsx)(F.default,{style:R.input,placeholder:"Seu e-mail",placeholderTextColor:"#A0AEC0",value:t,onChangeText:a,keyboardType:"email-address",autoCapitalize:"none"})]}),(0,g.jsxs)(C.default,{style:R.inputWrapper,children:[(0,g.jsx)(E.default,{name:"lock-outline",size:22,color:"#4A5568",style:R.inputIcon}),(0,g.jsx)(F.default,{style:R.input,placeholder:"Sua senha",placeholderTextColor:"#A0AEC0",value:l,onChangeText:i,secureTextEntry:!s}),(0,g.jsx)(v.default,{style:R.eyeIcon,onPress:()=>d(!s),children:(0,g.jsx)(I.default,{name:s?"eye-outline":"eye-off-outline",size:24,color:"#6B7280"})})]}),(0,g.jsx)(v.default,{onPress:()=>e.navigate("Recover"),style:R.forgotPassword,children:(0,g.jsx)(b.default,{style:R.forgotPasswordText,children:"Esqueci minha senha"})}),(0,g.jsx)(v.default,{style:[R.loginButton,c&&R.buttonDisabled],onPress:async()=>{if(t.trim()&&l){f(!0);try{(await(0,r.signInWithEmailAndPassword)(u,t.trim(),l)).user}catch(e){console.error("Erro no login:",e.code,e.message);let t="Email ou senha inv\xe1lidos. Por favor, tente novamente.";"auth/user-not-found"===e.code||"auth/wrong-password"===e.code||"auth/invalid-credential"===e.code?t="Credenciais inv\xe1lidas. Verifique seu email e senha.":"auth/invalid-email"===e.code?t="O formato do email \xe9 inv\xe1lido.":"auth/too-many-requests"===e.code?t="Muitas tentativas de login. Tente novamente mais tarde.":"auth/network-request-failed"===e.code&&(t="Erro de rede. Verifique sua conex\xe3o e tente novamente."),D.default.alert("Erro no Login",t)}finally{f(!1)}}else D.default.alert("Campos Obrigat\xf3rios","Por favor, preencha o email e a senha.")},activeOpacity:.8,disabled:c,children:c?(0,g.jsx)(z.default,{color:"#FFFFFF",size:"small"}):(0,g.jsx)(b.default,{style:R.loginButtonText,children:"ENTRAR"})}),(0,g.jsxs)(C.default,{style:R.divider,children:[(0,g.jsx)(C.default,{style:R.dividerLine}),(0,g.jsx)(b.default,{style:R.dividerText,children:"OU"}),(0,g.jsx)(C.default,{style:R.dividerLine})]}),(0,g.jsx)(v.default,{style:R.registerButton,onPress:()=>e.navigate("Register"),activeOpacity:.8,disabled:c,children:(0,g.jsx)(b.default,{style:R.registerButtonText,children:"CRIAR CONTA"})})]})]})]})})]})},R=S.default.create({container:{flex:1,backgroundColor:"#F9FAFB"},header:{height:60,backgroundColor:"#1D854C",justifyContent:"center",alignItems:"center",elevation:4},headerTitle:{fontSize:20,color:"#FFFFFF",fontWeight:"600"},content:{flex:1,paddingHorizontal:24,alignItems:"center",justifyContent:"center"},logo:{width:160,height:160,marginBottom:30},formContainer:{width:"100%",maxWidth:400},inputWrapper:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFFFFF",borderRadius:10,marginBottom:18,borderWidth:1,borderColor:"#E2E8F0",height:54,paddingHorizontal:5},inputIcon:{paddingHorizontal:12},input:{flex:1,height:"100%",color:"#1A202C",fontSize:16,paddingRight:10},eyeIcon:{paddingHorizontal:12},forgotPassword:{alignSelf:"flex-end",marginBottom:25,paddingVertical:5},forgotPasswordText:{color:"#1D854C",fontSize:14,fontWeight:"500"},loginButton:{backgroundColor:"#1D854C",borderRadius:10,height:52,justifyContent:"center",alignItems:"center",marginBottom:22,elevation:2,shadowColor:"#052e16",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:3},buttonDisabled:{backgroundColor:"#A5D6A7"},loginButtonText:{color:"#FFFFFF",fontSize:16,fontWeight:"600",letterSpacing:.5},divider:{flexDirection:"row",alignItems:"center",marginVertical:20},dividerLine:{flex:1,height:1,backgroundColor:"#E2E8F0"},dividerText:{paddingHorizontal:12,color:"#6B7280",fontSize:14,fontWeight:"500"},registerButton:{backgroundColor:"#FFFFFF",borderRadius:10,height:52,justifyContent:"center",alignItems:"center",marginBottom:20,borderWidth:1.5,borderColor:"#1D854C"},registerButtonText:{color:"#1D854C",fontSize:16,fontWeight:"600",letterSpacing:.5}});var W=o(8033);const L=[{label:"Selecione seu tipo de conta...",value:""},{label:"Sou Aluno(a)",value:"aluno"},{label:"Sou Professor(a)",value:"professor"},{label:"Sou Psicopedagogo(a)",value:"psicopedagogo"}],O=({navigation:e})=>{const[t,o]=(0,n.useState)(""),[a,i]=(0,n.useState)(""),[s,d]=(0,n.useState)(""),[c,h]=(0,n.useState)(""),[m,p]=(0,n.useState)(""),[x,y]=(0,n.useState)(L[0].value),[j,S]=(0,n.useState)(!1),[T,P]=(0,n.useState)(!1),[R,O]=(0,n.useState)(!1);return(0,g.jsxs)(B.default,{style:H.container,children:[(0,g.jsx)(k.default,{backgroundColor:"#1D854C",barStyle:"light-content"}),(0,g.jsxs)(A.default,{behavior:"height",style:{flex:1},children:[(0,g.jsxs)(C.default,{style:H.header,children:[(0,g.jsx)(v.default,{style:H.backButton,onPress:()=>e.goBack(),children:(0,g.jsx)(I.default,{name:"arrow-back-outline",size:26,color:"#FFFFFF"})}),(0,g.jsx)(b.default,{style:H.headerTitle,children:"Criar Nova Conta"}),(0,g.jsx)(C.default,{style:H.rightSpace})]}),(0,g.jsx)(w.default,{showsVerticalScrollIndicator:!1,contentContainerStyle:H.scrollContent,children:(0,g.jsxs)(C.default,{style:H.contentInner,children:[(0,g.jsx)(b.default,{style:H.formSectionTitle,children:"Informa\xe7\xf5es Pessoais"}),(0,g.jsxs)(C.default,{style:H.inputWrapper,children:[(0,g.jsx)(E.default,{name:"person-outline",size:22,color:"#4A5568",style:H.inputIcon}),(0,g.jsx)(F.default,{style:H.input,placeholder:"Nome completo",placeholderTextColor:"#A0AEC0",value:t,onChangeText:o})]}),(0,g.jsxs)(C.default,{style:H.inputWrapper,children:[(0,g.jsx)(E.default,{name:"alternate-email",size:22,color:"#4A5568",style:H.inputIcon}),(0,g.jsx)(F.default,{style:H.input,placeholder:"Seu melhor e-mail",placeholderTextColor:"#A0AEC0",value:a,onChangeText:i,keyboardType:"email-address",autoCapitalize:"none"})]}),(0,g.jsxs)(C.default,{style:H.inputWrapper,children:[(0,g.jsx)(E.default,{name:"phone-iphone",size:22,color:"#4A5568",style:H.inputIcon}),(0,g.jsx)(F.default,{style:H.input,placeholder:"N\xfamero de telefone (com DDD)",placeholderTextColor:"#A0AEC0",value:s,onChangeText:d,keyboardType:"phone-pad"})]}),(0,g.jsxs)(C.default,{style:H.inputField,children:[(0,g.jsx)(b.default,{style:H.inputLabel,children:"Tipo de Conta *"}),(0,g.jsx)(C.default,{style:H.pickerWrapper,children:(0,g.jsx)(W.Picker,{selectedValue:x,onValueChange:(e,t)=>y(e),style:H.picker,dropdownIconColor:"#1D854C",mode:"dropdown",children:L.map((e=>(0,g.jsx)(W.Picker.Item,{label:e.label,value:e.value,enabled:""!==e.value,style:""===e.value?H.pickerPlaceholderItem:{}},e.value)))})})]}),(0,g.jsx)(b.default,{style:[H.formSectionTitle,{marginTop:10}],children:"Seguran\xe7a da Conta"}),(0,g.jsxs)(C.default,{style:H.inputWrapper,children:[(0,g.jsx)(E.default,{name:"lock-outline",size:22,color:"#4A5568",style:H.inputIcon}),(0,g.jsx)(F.default,{style:H.input,placeholder:"Crie uma senha forte",placeholderTextColor:"#A0AEC0",value:c,onChangeText:h,secureTextEntry:!j}),(0,g.jsx)(v.default,{style:H.eyeIcon,onPress:()=>S(!j),children:(0,g.jsx)(I.default,{name:j?"eye-outline":"eye-off-outline",size:24,color:"#6B7280"})})]}),(0,g.jsxs)(C.default,{style:H.inputWrapper,children:[(0,g.jsx)(E.default,{name:"lock-outline",size:22,color:"#4A5568",style:H.inputIcon}),(0,g.jsx)(F.default,{style:H.input,placeholder:"Confirme sua senha",placeholderTextColor:"#A0AEC0",value:m,onChangeText:p,secureTextEntry:!T}),(0,g.jsx)(v.default,{style:H.eyeIcon,onPress:()=>P(!T),children:(0,g.jsx)(I.default,{name:T?"eye-outline":"eye-off-outline",size:24,color:"#6B7280"})})]}),(0,g.jsx)(v.default,{style:[H.actionButton,R&&H.buttonDisabled],onPress:async()=>{if(t.trim()&&a.trim()&&s.trim()&&c&&m&&x)if(c===m)if(c.length<6)D.default.alert("Senha Fraca","A senha deve ter pelo menos 6 caracteres.");else{O(!0);try{const e=(await(0,r.createUserWithEmailAndPassword)(u,a.trim(),c)).user;await(0,r.updateProfile)(e,{displayName:t.trim()});const o=(0,l.ref)(f,`users/${e.uid}`);await(0,l.set)(o,{uid:e.uid,name:t.trim(),email:a.trim().toLowerCase(),phone:s.trim(),role:x,isAdmin:!1,createdAt:(0,l.serverTimestamp)(),profileImageUrl:null})}catch(e){console.error("Erro no registro:",e.code,e.message);let t="N\xe3o foi poss\xedvel criar a conta. Tente novamente.";"auth/email-already-in-use"===e.code?t="Este endere\xe7o de e-mail j\xe1 est\xe1 em uso por outra conta.":"auth/invalid-email"===e.code?t="O formato do email \xe9 inv\xe1lido.":"auth/weak-password"===e.code?t="A senha \xe9 muito fraca. Use pelo menos 6 caracteres.":"auth/network-request-failed"===e.code&&(t="Erro de rede. Verifique sua conex\xe3o e tente novamente."),D.default.alert("Erro no Cadastro",t)}finally{O(!1)}}else D.default.alert("Erro de Senha","As senhas n\xe3o coincidem.");else D.default.alert("Campos Obrigat\xf3rios","Por favor, preencha todos os campos, incluindo o tipo de conta.")},activeOpacity:.8,disabled:R,children:R?(0,g.jsx)(z.default,{color:"#FFFFFF",size:"small"}):(0,g.jsx)(b.default,{style:H.actionButtonText,children:"CRIAR MINHA CONTA"})}),(0,g.jsx)(v.default,{onPress:()=>e.navigate("Login"),style:H.loginLink,disabled:R,children:(0,g.jsxs)(b.default,{style:H.loginLinkText,children:["J\xe1 possui uma conta? ",(0,g.jsx)(b.default,{style:H.loginLinkTextBold,children:"Fa\xe7a login"})]})})]})})]})]})},H=S.default.create({container:{flex:1,backgroundColor:"#F9FAFB"},header:{height:60,backgroundColor:"#1D854C",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:16,elevation:4},backButton:{padding:8},rightSpace:{width:40},headerTitle:{fontSize:20,color:"#FFFFFF",fontWeight:"600"},scrollContent:{flexGrow:1,justifyContent:"center"},contentInner:{paddingHorizontal:24,paddingVertical:20},formSectionTitle:{alignSelf:"flex-start",fontSize:18,fontWeight:"600",color:"#1F2937",marginBottom:20,marginTop:10},inputField:{marginBottom:18},inputLabel:{fontSize:15,color:"#4A5568",marginBottom:8,fontWeight:"500"},inputWrapper:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFFFFF",borderRadius:10,marginBottom:18,borderWidth:1,borderColor:"#E2E8F0",height:54,paddingHorizontal:5,width:"100%"},inputIcon:{paddingHorizontal:12},input:{flex:1,height:"100%",color:"#1A202C",fontSize:16,paddingRight:10},eyeIcon:{paddingHorizontal:12},pickerWrapper:{backgroundColor:"#FFFFFF",borderRadius:10,borderWidth:1,borderColor:"#E2E8F0",height:54,justifyContent:"center",width:"100%"},picker:{height:"100%",width:"100%",color:"#1A202C"},pickerPlaceholderItem:{color:"#A0AEC0"},actionButton:{backgroundColor:"#1D854C",borderRadius:10,height:52,justifyContent:"center",alignItems:"center",marginTop:25,elevation:2,shadowColor:"#052e16",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:3,width:"100%"},buttonDisabled:{backgroundColor:"#A5D6A7"},actionButtonText:{color:"#FFFFFF",fontSize:16,fontWeight:"600",letterSpacing:.5},loginLink:{marginTop:20,marginBottom:24,alignSelf:"center"},loginLinkText:{color:"#6B7280",fontSize:14,fontWeight:"500"},loginLinkTextBold:{color:"#1D854C",fontWeight:"bold"}}),N=({navigation:e})=>{const[t,o]=(0,n.useState)(""),[a,l]=(0,n.useState)(!1);return(0,g.jsxs)(B.default,{style:V.container,children:[(0,g.jsx)(k.default,{backgroundColor:"#1D854C",barStyle:"light-content"}),(0,g.jsxs)(A.default,{behavior:"height",style:{flex:1},children:[(0,g.jsxs)(C.default,{style:V.header,children:[(0,g.jsx)(v.default,{style:V.backButton,onPress:()=>e.goBack(),children:(0,g.jsx)(I.default,{name:"arrow-back-outline",size:26,color:"#FFFFFF"})}),(0,g.jsx)(b.default,{style:V.headerTitle,children:"Recuperar Senha"}),(0,g.jsx)(C.default,{style:V.rightSpace})]}),(0,g.jsx)(w.default,{contentContainerStyle:{flexGrow:1},children:(0,g.jsxs)(C.default,{style:V.contentInner,children:[(0,g.jsx)(I.default,{name:"lock-open-outline",size:80,color:"#1D854C",style:{alignSelf:"center",marginBottom:25}}),(0,g.jsx)(b.default,{style:V.pageTitle,children:"Esqueceu sua senha?"}),(0,g.jsx)(b.default,{style:V.pageSubtitle,children:"Sem problemas! Insira seu e-mail abaixo e enviaremos um link para voc\xea criar uma nova senha."}),(0,g.jsxs)(C.default,{style:V.inputWrapper,children:[(0,g.jsx)(E.default,{name:"alternate-email",size:22,color:"#4A5568",style:V.inputIcon}),(0,g.jsx)(F.default,{style:V.input,placeholder:"Seu endere\xe7o de e-mail cadastrado",placeholderTextColor:"#A0AEC0",value:t,onChangeText:o,keyboardType:"email-address",autoCapitalize:"none"})]}),(0,g.jsx)(v.default,{style:[V.actionButton,a&&V.buttonDisabled],onPress:async()=>{if(t.trim()){l(!0);try{await(0,r.sendPasswordResetEmail)(u,t.trim()),D.default.alert("Verifique seu E-mail",`Enviamos instru\xe7\xf5es para ${t.trim()} para voc\xea redefinir sua senha.`,[{text:"OK",onPress:()=>e.navigate("Login")}])}catch(o){console.error("Erro ao recuperar senha:",o.code,o.message);let e="N\xe3o foi poss\xedvel enviar o e-mail de recupera\xe7\xe3o. Tente novamente.";"auth/user-not-found"===o.code?e="Nenhuma conta encontrada com este endere\xe7o de e-mail.":"auth/invalid-email"===o.code?e="O formato do email \xe9 inv\xe1lido.":"auth/network-request-failed"===o.code&&(e="Erro de rede. Verifique sua conex\xe3o e tente novamente."),D.default.alert("Erro",e)}finally{l(!1)}}else D.default.alert("Campo Obrigat\xf3rio","Por favor, informe seu endere\xe7o de e-mail.")},activeOpacity:.8,disabled:a,children:a?(0,g.jsx)(z.default,{color:"#FFFFFF",size:"small"}):(0,g.jsx)(b.default,{style:V.actionButtonText,children:"ENVIAR INSTRU\xc7\xd5ES"})}),(0,g.jsx)(v.default,{style:V.loginLink,onPress:()=>e.navigate("Login"),disabled:a,children:(0,g.jsxs)(b.default,{style:V.loginLinkText,children:["Lembrou a senha? ",(0,g.jsx)(b.default,{style:V.loginLinkTextBold,children:"Voltar para Login"})]})})]})})]})]})},V=S.default.create({container:{flex:1,backgroundColor:"#F9FAFB"},header:{height:60,backgroundColor:"#1D854C",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:16,elevation:4},backButton:{padding:8},rightSpace:{width:40},headerTitle:{fontSize:20,color:"#FFFFFF",fontWeight:"600"},scrollContent:{flexGrow:1,justifyContent:"center"},contentInner:{padding:24,alignItems:"center"},logoImage:{width:100,height:100,marginBottom:30},pageTitle:{fontSize:24,fontWeight:"bold",color:"#1F2937",marginBottom:12,textAlign:"center"},pageSubtitle:{fontSize:15,color:"#6B7280",textAlign:"center",marginBottom:35,lineHeight:22,paddingHorizontal:10},inputWrapper:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFFFFF",borderRadius:10,marginBottom:25,borderWidth:1,borderColor:"#E2E8F0",height:54,paddingHorizontal:5,width:"100%"},inputIcon:{paddingHorizontal:12},input:{flex:1,height:"100%",color:"#1A202C",fontSize:16},actionButton:{backgroundColor:"#1D854C",borderRadius:10,height:52,justifyContent:"center",alignItems:"center",marginBottom:25,elevation:2,shadowColor:"#052e16",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:3,width:"100%"},buttonDisabled:{backgroundColor:"#A5D6A7"},actionButtonText:{color:"#FFFFFF",fontSize:16,fontWeight:"600",letterSpacing:.5},loginLink:{marginTop:10,marginBottom:24},loginLinkText:{color:"#6B7280",fontSize:14,fontWeight:"500"},loginLinkTextBold:{color:"#1D854C",fontWeight:"bold"}});var U=o(68503);const q=({navigation:e})=>{const{userData:t}=x(),[o,a]=(0,n.useState)("Usu\xe1rio"),[r,i]=(0,n.useState)([]),[s,d]=(0,n.useState)(!0);(0,n.useEffect)((()=>{if(t&&t.uid){a(t.name||"Usu\xe1rio");const e=(new Date).toISOString().split("T")[0],o=(0,l.query)((0,l.ref)(f,"events"),(0,l.orderByChild)("date"),(0,l.startAt)(e)),n=(0,l.onValue)(o,(e=>{const o=[];e.forEach((e=>{const a=Object.assign({id:e.key},e.val());let n=!1;(a.createdBy===t.uid||a.attendees&&a.attendees[t.uid]||a.classId&&t.associatedClasses&&t.associatedClasses[a.classId])&&(n=!0),n&&o.push(a)})),o.sort(((e,t)=>e.date<t.date?-1:e.date>t.date?1:e.time<t.time?-1:e.time>t.time?1:0)),i(o.slice(0,3)),d(!1)}),(e=>{console.error("Erro ao buscar eventos:",e),i([]),d(!1)}));return()=>n()}d(!1),i([]),a("Usu\xe1rio")}),[t]);const c=(e,t)=>{try{const o=new Date(e+"T"+(t||"00:00:00"));if(isNaN(o.getTime())){const o=e.split("/");if(3===o.length){const e=`${o[2]}-${o[1]}-${o[0]}`,a=new Date(e+"T"+(t||"00:00:00"));if(!isNaN(a.getTime()))return`${a.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})} \xe0s ${t||""}`}return`${e} \xe0s ${t||""}`}return`${o.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})} \xe0s ${t||""}`}catch(o){return`${e} \xe0s ${t||""}`}};return(0,g.jsxs)(B.default,{style:M.container,children:[(0,g.jsx)(k.default,{backgroundColor:"#FFFFFF",barStyle:"dark-content"}),(0,g.jsx)(C.default,{style:M.header,children:(0,g.jsxs)(v.default,{onPress:()=>e.navigate("Profile"),style:M.profileContainer,children:[(0,g.jsx)(C.default,{style:M.defaultAvatar,children:(0,g.jsx)(I.default,{name:"person-circle-outline",size:40,color:"#1D854C"})}),(0,g.jsxs)(C.default,{children:[(0,g.jsx)(b.default,{style:M.greetingSubText,children:"Bem-vindo(a),"}),(0,g.jsxs)(b.default,{style:M.greetingText,children:[o,"!"]})]})]})}),(0,g.jsxs)(w.default,{style:M.scrollContent,showsVerticalScrollIndicator:!1,keyboardShouldPersistTaps:"handled",children:[(0,g.jsxs)(C.default,{style:M.sectionContainer,children:[(0,g.jsxs)(C.default,{style:M.sectionHeader,children:[(0,g.jsx)(b.default,{style:M.sectionTitle,children:"Pr\xf3ximos Eventos"}),(0,g.jsx)(v.default,{onPress:()=>e.navigate("Agenda"),children:(0,g.jsx)(b.default,{style:M.seeAllText,children:"Ver todos"})})]}),s?(0,g.jsx)(z.default,{size:"large",color:"#1D854C",style:M.loader}):r.length>0?r.map((t=>(0,g.jsxs)(v.default,{style:M.eventCard,onPress:()=>e.navigate("Agenda",{eventId:t.id,screenTitle:t.title}),children:[(0,g.jsx)(C.default,{style:[M.eventIconContainer,{backgroundColor:t.isOnline?"#E3F2FD":"#E8F5E9"}],children:(0,g.jsx)(U.default,{name:t.isOnline?"video-outline":"calendar-today",size:24,color:t.isOnline?"#2196F3":"#4CAF50"})}),(0,g.jsxs)(C.default,{style:M.eventDetails,children:[(0,g.jsx)(b.default,{style:M.eventTitle,numberOfLines:1,children:t.title}),(0,g.jsx)(b.default,{style:M.eventDateTime,children:c(t.date,t.time)}),(0,g.jsxs)(b.default,{style:M.eventLocation,numberOfLines:1,children:[(0,g.jsx)(I.default,{name:"location-outline",size:14,color:"#757575"})," ",t.location]})]}),(0,g.jsx)(I.default,{name:"chevron-forward",size:22,color:"#BDBDBD"})]},t.id))):(0,g.jsxs)(C.default,{style:M.emptyStateContainer,children:[(0,g.jsx)(U.default,{name:"calendar-blank-outline",size:48,color:"#CBD5E0"}),(0,g.jsx)(b.default,{style:M.emptyStateText,children:"Nenhum evento relevante nos pr\xf3ximos dias."})]})]}),(0,g.jsxs)(C.default,{style:M.sectionContainer,children:[(0,g.jsx)(b.default,{style:M.sectionTitle,children:"Acesso R\xe1pido"}),(0,g.jsx)(C.default,{style:M.shortcutsGrid,children:[{id:1,title:"Agenda",iconName:"calendar-month-outline",screen:"Agenda",color:"#4CAF50"},{id:2,title:"Arquivos",iconName:"folder-open-outline",screen:"Arquivos",color:"#2196F3"},{id:3,title:"Tarefas",iconName:"checkbox-marked-circle-outline",screen:"Tarefas",color:"#FF9800"},{id:4,title:"Notas",iconName:"note-text-outline",screen:"Notas",color:"#9C27B0"}].map((t=>(0,g.jsxs)(v.default,{onPress:()=>e.navigate(t.screen),style:M.shortcutCard,activeOpacity:.8,children:[(0,g.jsx)(C.default,{style:[M.shortcutIconContainer,{backgroundColor:`${t.color}25`}],children:(0,g.jsx)(U.default,{name:t.iconName,size:30,color:t.color})}),(0,g.jsx)(b.default,{style:M.shortcutTitle,children:t.title})]},t.id)))})]})]})]})},M=S.default.create({container:{flex:1,backgroundColor:"#F8F9FA"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#FFFFFF",paddingHorizontal:20,paddingVertical:15,borderBottomWidth:1,borderBottomColor:"#E5E7EB"},profileContainer:{flexDirection:"row",alignItems:"center"},defaultAvatar:{width:44,height:44,borderRadius:22,backgroundColor:"#E0E7FF",justifyContent:"center",alignItems:"center",marginRight:12},greetingSubText:{fontSize:13,color:"#6B7280"},greetingText:{fontSize:18,fontWeight:"bold",color:"#1F2937"},headerIconsContainer:{flexDirection:"row"},iconButton:{padding:8},scrollContent:{flexGrow:1,paddingHorizontal:20},sectionContainer:{paddingVertical:24},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:18},sectionTitle:{fontSize:20,fontWeight:"bold",color:"#111827"},seeAllText:{fontSize:14,color:"#1D854C",fontWeight:"600"},loader:{marginVertical:30},eventCard:{backgroundColor:"#FFFFFF",borderRadius:12,padding:16,marginBottom:14,flexDirection:"row",alignItems:"center",elevation:2,shadowColor:"#000000",shadowOffset:{width:0,height:2},shadowOpacity:.06,shadowRadius:4},eventIconContainer:{width:48,height:48,borderRadius:24,justifyContent:"center",alignItems:"center",marginRight:16},eventDetails:{flex:1,marginRight:8},eventTitle:{fontSize:16,fontWeight:"600",color:"#1F2937",marginBottom:5},eventDateTime:{fontSize:14,color:"#4B5563",marginBottom:4},eventLocation:{fontSize:14,color:"#6B7280",flexDirection:"row",alignItems:"center"},emptyStateContainer:{alignItems:"center",justifyContent:"center",paddingVertical:50,backgroundColor:"#FFFFFF",borderRadius:12,borderWidth:1,borderColor:"#E5E7EB",marginTop:10},emptyStateText:{marginTop:16,fontSize:15,color:"#6B7280",textAlign:"center",lineHeight:22},shortcutsGrid:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",marginTop:10},shortcutCard:{backgroundColor:"#FFFFFF",borderRadius:12,paddingVertical:20,paddingHorizontal:10,alignItems:"center",width:"48%",marginBottom:16,minHeight:130,justifyContent:"center",elevation:2,shadowColor:"#000000",shadowOffset:{width:0,height:2},shadowOpacity:.06,shadowRadius:4},shortcutIconContainer:{width:56,height:56,borderRadius:16,justifyContent:"center",alignItems:"center",marginBottom:12},shortcutTitle:{fontSize:14,fontWeight:"500",color:"#374151",textAlign:"center"}});var $=o(22480);const G=({isVisible:e,onClose:t})=>{const[o,a]=(0,n.useState)(""),[l,i]=(0,n.useState)(""),[s,d]=(0,n.useState)(""),[c,f]=(0,n.useState)(!1),[h,m]=(0,n.useState)(!1),[p,x]=(0,n.useState)(!1),[y,j]=(0,n.useState)(!1),S=()=>{a(""),i(""),d(""),m(!1),x(!1),j(!1)};return(0,g.jsx)($.default,{isVisible:e,onSwipeComplete:t,swipeDirection:["down"],onBackdropPress:t,onModalHide:S,style:_.modal,avoidKeyboard:!0,children:(0,g.jsxs)(C.default,{style:_.modalContent,children:[(0,g.jsxs)(C.default,{style:_.modalHeader,children:[(0,g.jsx)(b.default,{style:_.modalTitle,children:"Alterar Senha"}),(0,g.jsx)(v.default,{onPress:t,children:(0,g.jsx)(I.default,{name:"close-outline",size:28,color:"#333"})})]}),(0,g.jsx)(w.default,{keyboardShouldPersistTaps:"handled",children:(0,g.jsxs)(C.default,{style:_.formContainer,children:[(0,g.jsx)(b.default,{style:_.infoText,children:"Para sua seguran\xe7a, voc\xea precisar\xe1 confirmar sua senha atual antes de definir uma nova."}),(0,g.jsxs)(C.default,{style:_.inputField,children:[(0,g.jsx)(b.default,{style:_.inputLabel,children:"Senha Atual"}),(0,g.jsxs)(C.default,{style:_.passwordInputContainer,children:[(0,g.jsx)(F.default,{style:_.input,value:o,onChangeText:a,placeholder:"Sua senha atual",secureTextEntry:!h,placeholderTextColor:"#A0AEC0"}),(0,g.jsx)(v.default,{onPress:()=>m(!h),style:_.eyeIcon,children:(0,g.jsx)(I.default,{name:h?"eye-outline":"eye-off-outline",size:24,color:"#6B7280"})})]})]}),(0,g.jsxs)(C.default,{style:_.inputField,children:[(0,g.jsx)(b.default,{style:_.inputLabel,children:"Nova Senha"}),(0,g.jsxs)(C.default,{style:_.passwordInputContainer,children:[(0,g.jsx)(F.default,{style:_.input,value:l,onChangeText:i,placeholder:"M\xednimo 6 caracteres",secureTextEntry:!p,placeholderTextColor:"#A0AEC0"}),(0,g.jsx)(v.default,{onPress:()=>x(!p),style:_.eyeIcon,children:(0,g.jsx)(I.default,{name:p?"eye-outline":"eye-off-outline",size:24,color:"#6B7280"})})]})]}),(0,g.jsxs)(C.default,{style:_.inputField,children:[(0,g.jsx)(b.default,{style:_.inputLabel,children:"Confirmar Nova Senha"}),(0,g.jsxs)(C.default,{style:_.passwordInputContainer,children:[(0,g.jsx)(F.default,{style:_.input,value:s,onChangeText:d,placeholder:"Repita a nova senha",secureTextEntry:!y,placeholderTextColor:"#A0AEC0"}),(0,g.jsx)(v.default,{onPress:()=>j(!y),style:_.eyeIcon,children:(0,g.jsx)(I.default,{name:y?"eye-outline":"eye-off-outline",size:24,color:"#6B7280"})})]})]}),(0,g.jsx)(v.default,{style:[_.confirmButton,c&&_.confirmButtonDisabled],onPress:async()=>{if(!o||!l||!s)return void D.default.alert("Campos Obrigat\xf3rios","Por favor, preencha todos os campos.");if(l!==s)return void D.default.alert("Erro","A nova senha e a confirma\xe7\xe3o n\xe3o coincidem.");if(l.length<6)return void D.default.alert("Senha Fraca","A nova senha deve ter pelo menos 6 caracteres.");f(!0);const e=u.currentUser;if(e)try{const a=r.EmailAuthProvider.credential(e.email,o);await(0,r.reauthenticateWithCredential)(e,a),await(0,r.updatePassword)(e,l),D.default.alert("Sucesso","Senha alterada com sucesso!"),S(),t()}catch(a){console.error("Erro ao alterar senha:",a);let e="N\xe3o foi poss\xedvel alterar a senha.";"auth/wrong-password"===a.code?e="A senha atual est\xe1 incorreta.":"auth/weak-password"===a.code?e="A nova senha \xe9 muito fraca.":"auth/requires-recent-login"===a.code&&(e="Esta opera\xe7\xe3o \xe9 sens\xedvel e requer login recente. Por favor, fa\xe7a login novamente e tente de novo."),D.default.alert("Erro",e)}finally{f(!1)}else D.default.alert("Erro","Usu\xe1rio n\xe3o encontrado. Por favor, fa\xe7a login novamente."),f(!1),t()},disabled:c,children:c?(0,g.jsx)(z.default,{color:"#FFFFFF"}):(0,g.jsx)(b.default,{style:_.confirmButtonText,children:"Confirmar Altera\xe7\xe3o"})})]})})]})})},_=S.default.create({modal:{justifyContent:"flex-end",margin:0},modalContent:{backgroundColor:"#FFFFFF",paddingTop:15,borderTopRightRadius:25,borderTopLeftRadius:25,maxHeight:"80%",paddingBottom:20},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBottom:15,paddingHorizontal:20,marginBottom:10},modalTitle:{fontSize:22,fontWeight:"bold",color:"#1F2937"},formContainer:{paddingHorizontal:20,paddingBottom:20},infoText:{fontSize:14,color:"#4B5563",marginBottom:20,textAlign:"center",lineHeight:20},inputField:{marginBottom:20},inputLabel:{fontSize:15,color:"#4A5568",marginBottom:8,fontWeight:"500"},passwordInputContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F7F8FC",borderRadius:10,borderWidth:1,borderColor:"#E2E8F0"},input:{flex:1,height:52,paddingHorizontal:15,fontSize:16,color:"#2D3748"},eyeIcon:{padding:12},confirmButton:{backgroundColor:"#1D854C",borderRadius:10,height:52,justifyContent:"center",alignItems:"center",marginTop:25,elevation:2},confirmButtonDisabled:{backgroundColor:"#A5D6A7"},confirmButtonText:{color:"#FFFFFF",fontSize:17,fontWeight:"600"}}),J=({navigation:e})=>{const{userData:t,logout:o,fetchUserDataFromDB:a}=x(),[i,s]=(0,n.useState)(""),[d,c]=(0,n.useState)(""),[h,m]=(0,n.useState)(""),[p,y]=(0,n.useState)(!1),[j,S]=(0,n.useState)(!1),[T,A]=(0,n.useState)(""),[E,P]=(0,n.useState)(!1);(0,n.useEffect)((()=>{t?(s(t.name||u.currentUser?.displayName||""),c(t.email||u.currentUser?.email||""),m(t.phone||"")):u.currentUser&&(s(u.currentUser.displayName||""),c(u.currentUser.email||""))}),[t]);return t||u.currentUser?(0,g.jsxs)(B.default,{style:K.container,children:[(0,g.jsx)(k.default,{backgroundColor:"#1D854C",barStyle:"light-content"}),(0,g.jsxs)(C.default,{style:K.headerBar,children:[(0,g.jsx)(v.default,{onPress:()=>e.goBack(),style:K.headerButton,children:(0,g.jsx)(I.default,{name:"arrow-back-outline",size:26,color:"#FFFFFF"})}),(0,g.jsx)(b.default,{style:K.headerTitle,children:"Meu Perfil"}),(0,g.jsx)(v.default,{onPress:()=>y(!p),style:K.headerButton,children:(0,g.jsx)(I.default,{name:p?"close-circle-outline":"create-outline",size:26,color:"#FFFFFF"})})]}),(0,g.jsxs)(w.default,{contentContainerStyle:K.scrollContent,showsVerticalScrollIndicator:!1,keyboardShouldPersistTaps:"handled",children:[(0,g.jsxs)(C.default,{style:K.profileInfoDirect,children:[(0,g.jsx)(b.default,{style:K.profileName,children:i||"Carregando nome..."}),(0,g.jsx)(b.default,{style:K.profileEmail,children:d||"Carregando email..."})]}),(0,g.jsxs)(C.default,{style:K.formSection,children:[(0,g.jsx)(b.default,{style:K.sectionTitle,children:"Informa\xe7\xf5es Pessoais"}),(0,g.jsxs)(C.default,{style:K.inputGroup,children:[(0,g.jsx)(I.default,{name:"person-outline",size:22,color:"#4A5568",style:K.inputIcon}),(0,g.jsx)(F.default,{style:[K.input,!p&&K.inputDisabled],placeholder:"Nome completo",value:i,onChangeText:s,editable:p,placeholderTextColor:"#A0AEC0"})]}),(0,g.jsxs)(C.default,{style:K.inputGroup,children:[(0,g.jsx)(I.default,{name:"mail-outline",size:22,color:"#4A5568",style:K.inputIcon}),(0,g.jsx)(F.default,{style:[K.input,!p&&K.inputDisabled],placeholder:"Endere\xe7o de e-mail",value:d,onChangeText:c,editable:p,keyboardType:"email-address",autoCapitalize:"none",placeholderTextColor:"#A0AEC0"})]}),(0,g.jsxs)(C.default,{style:K.inputGroup,children:[(0,g.jsx)(I.default,{name:"call-outline",size:22,color:"#4A5568",style:K.inputIcon}),(0,g.jsx)(F.default,{style:[K.input,!p&&K.inputDisabled],placeholder:"N\xfamero de telefone (opcional)",value:h,onChangeText:m,editable:p,keyboardType:"phone-pad",placeholderTextColor:"#A0AEC0"})]}),p&&(0,g.jsx)(v.default,{style:K.saveButton,onPress:async()=>{if(!i.trim())return void D.default.alert("Campo Obrigat\xf3rio","O nome n\xe3o pode estar vazio.");if(!u.currentUser)return void D.default.alert("Erro","Usu\xe1rio n\xe3o autenticado.");S(!0);const e=u.currentUser,o={},n={},s=e.displayName,c=t?.name,g=e.email,m=t?.phone;if(i!==(c||s)&&(o.name=i.trim(),n.displayName=i.trim()),h!==m&&(o.phone=h.trim()),d.trim().toLowerCase()!==g.toLowerCase()){if(!T)return void D.default.prompt("Alterar Email","Para sua seguran\xe7a, por favor, insira sua senha atual para alterar o email.",[{text:"Cancelar",style:"cancel",onPress:()=>S(!1)},{text:"Confirmar",onPress:e=>{e?(A(e),D.default.alert("Senha Inserida","Por favor, clique em 'Salvar Altera\xe7\xf5es' novamente para confirmar a mudan\xe7a de e-mail.")):D.default.alert("Senha Obrigat\xf3ria","A senha \xe9 necess\xe1ria para alterar o email."),S(!1)}}],"secure-text");try{const t=r.EmailAuthProvider.credential(g,T);await(0,r.reauthenticateWithCredential)(e,t),await(0,r.updateEmail)(e,d.trim()),o.email=d.trim().toLowerCase(),A(""),D.default.alert("Email Atualizado","Seu email foi alterado com sucesso. Pode ser necess\xe1rio fazer login novamente com o novo e-mail.")}catch(p){console.error("Erro ao reautenticar ou atualizar email:",p);let e="N\xe3o foi poss\xedvel atualizar o email. Verifique sua senha.";return"auth/wrong-password"===p.code?e="Senha atual incorreta.":"auth/email-already-in-use"===p.code?e="Este email j\xe1 est\xe1 em uso por outra conta.":"auth/invalid-email"===p.code?e="O formato do email \xe9 inv\xe1lido.":"auth/requires-recent-login"===p.code&&(e="Esta opera\xe7\xe3o \xe9 sens\xedvel e requer login recente. Por favor, fa\xe7a login novamente."),D.default.alert("Erro de Email",e),S(!1),void A("")}}try{let t=!1;if(Object.keys(n).length>0&&(await(0,r.updateProfile)(e,n),t=!0),Object.keys(o).length>0){const a=(0,l.ref)(f,`users/${e.uid}`);await(0,l.update)(a,o),t=!0}t?(D.default.alert("Sucesso","Perfil atualizado!"),a&&await a(e.uid)):D.default.alert("Informa\xe7\xe3o","Nenhuma altera\xe7\xe3o detectada para salvar."),y(!1)}catch(p){console.error("Erro ao atualizar perfil:",p),D.default.alert("Erro","N\xe3o foi poss\xedvel atualizar o perfil.")}finally{S(!1)}},disabled:j,children:j?(0,g.jsx)(z.default,{color:"#FFFFFF"}):(0,g.jsx)(b.default,{style:K.saveButtonText,children:"Salvar Altera\xe7\xf5es"})})]}),(0,g.jsxs)(C.default,{style:K.actionsSection,children:[(0,g.jsx)(b.default,{style:K.sectionTitle,children:"Conta"}),(0,g.jsxs)(v.default,{style:K.actionButton,onPress:()=>P(!0),children:[(0,g.jsx)(I.default,{name:"lock-closed-outline",size:22,color:"#4A5568",style:K.actionIcon}),(0,g.jsx)(b.default,{style:K.actionButtonText,children:"Alterar Senha"}),(0,g.jsx)(I.default,{name:"chevron-forward-outline",size:22,color:"#CBD5E0"})]}),(0,g.jsxs)(v.default,{style:[K.actionButton,K.logoutButton],onPress:async()=>{D.default.alert("Sair da Conta","Voc\xea tem certeza que deseja sair?",[{text:"Cancelar",style:"cancel"},{text:"Sair",style:"destructive",onPress:async()=>{o?(await o(),e.reset({index:0,routes:[{name:"Login"}]})):(console.error("Fun\xe7\xe3o de logout n\xe3o encontrada no AuthContext."),await u.signOut(),e.reset({index:0,routes:[{name:"Login"}]}))}}],{cancelable:!0})},children:[(0,g.jsx)(I.default,{name:"log-out-outline",size:22,color:"#EF4444",style:K.actionIcon}),(0,g.jsx)(b.default,{style:[K.actionButtonText,K.logoutButtonText],children:"Sair da Conta"})]})]})]}),(0,g.jsx)(G,{isVisible:E,onClose:()=>P(!1)})]}):(0,g.jsx)(B.default,{style:K.container,children:(0,g.jsx)(C.default,{style:K.loadingContainer,children:(0,g.jsx)(z.default,{size:"large",color:"#1D854C"})})})},K=S.default.create({container:{flex:1,backgroundColor:"#F9FAFB"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#FFFFFF"},headerBar:{height:60,backgroundColor:"#1D854C",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:12,elevation:4},headerButton:{padding:10},headerTitle:{fontSize:20,color:"#FFFFFF",fontWeight:"600"},scrollContent:{paddingBottom:40},profileInfoDirect:{alignItems:"center",paddingVertical:25,backgroundColor:"#FFFFFF",borderBottomWidth:1,borderBottomColor:"#E5E7EB",marginBottom:20},profileName:{fontSize:24,fontWeight:"bold",color:"#1A202C",marginBottom:6},profileEmail:{fontSize:16,color:"#6B7280"},formSection:{paddingHorizontal:20,marginBottom:20},sectionTitle:{fontSize:18,fontWeight:"600",color:"#374151",marginBottom:18,marginTop:10},inputGroup:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFFFFF",borderRadius:10,borderWidth:1,borderColor:"#D1D5DB",marginBottom:18,paddingHorizontal:12,height:54},inputIcon:{marginRight:12},input:{flex:1,height:"100%",fontSize:16,color:"#1F2937"},inputDisabled:{color:"#6B7280",backgroundColor:"#F3F4F6"},saveButton:{backgroundColor:"#1D854C",borderRadius:10,height:52,justifyContent:"center",alignItems:"center",marginTop:15,elevation:2},saveButtonText:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},actionsSection:{paddingHorizontal:20,marginTop:10},actionButton:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFFFFF",paddingVertical:18,paddingHorizontal:15,borderRadius:10,borderWidth:1,borderColor:"#E5E7EB",marginBottom:12},actionIcon:{marginRight:15},actionButtonText:{flex:1,fontSize:16,color:"#374151",fontWeight:"500"},logoutButton:{borderColor:"#FCA5A5"},logoutButtonText:{color:"#EF4444"}});var Q=o(68202);const Y=({label:e,options:t,selectedValue:o,onValueChange:a,disabled:r})=>{const[l,i]=(0,n.useState)(!1);return(0,g.jsxs)(C.default,{style:te.inputField,children:[(0,g.jsx)(b.default,{style:te.inputLabel,children:e}),(0,g.jsxs)(v.default,{onPress:()=>!r&&i(!l),style:[te.pickerButton,r&&te.disabledInput],children:[(0,g.jsx)(b.default,{style:te.pickerButtonText,children:t.find((e=>e.value===o))?.label||"Selecione..."}),(0,g.jsx)(I.default,{name:l?"chevron-up-outline":"chevron-down-outline",size:22,color:"#555"})]}),l&&!r&&(0,g.jsx)(C.default,{style:te.pickerOptionsContainer,children:t.map((e=>(0,g.jsx)(v.default,{style:te.pickerOption,onPress:()=>{a(e.value),i(!1)},children:(0,g.jsx)(b.default,{children:e.label})},e.value)))})]})},X=[{id:"geral",name:"Geral",color:"#78909C"},{id:"aula",name:"Aula",color:"#42A5F5"},{id:"projeto",name:"Projeto",color:"#66BB6A"},{id:"reuniao",name:"Reuni\xe3o",color:"#FFA726"},{id:"pessoal",name:"Pessoal",color:"#AB47BC"},{id:"ideia",name:"Ideia",color:"#26A69A"}],Z=["#FFCDD2","#C5CAE9","#B2DFDB","#FFF9C4","#D1C4E9","#FFCCBC","#CFD8DC"],ee=({isVisible:e,onClose:t,onNoteSaved:o,existingNote:a})=>{const[r,l]=(0,n.useState)(null),[i,s]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[f,h]=(0,n.useState)(X[0].id),[m,p]=(0,n.useState)(Z[0]),[x,y]=(0,n.useState)(!1),j=!!a;(0,n.useEffect)((()=>{e&&(j&&a?(l(a.id),s(a.title||""),u(a.content||""),h(a.category||X[0].id),p(a.color||Z[0])):(l(null),s(""),u(""),h(X[0].id),p(Z[0])))}),[a,e,j]);const S=X.map((e=>({label:e.name,value:e.id})));return(0,g.jsx)($.default,{isVisible:e,onSwipeComplete:t,swipeDirection:["down"],onBackdropPress:t,style:te.modal,avoidKeyboard:!0,children:(0,g.jsxs)(C.default,{style:te.modalContent,children:[(0,g.jsxs)(C.default,{style:te.modalHeader,children:[(0,g.jsx)(b.default,{style:te.modalTitle,children:j?"Editar Nota":"Nova Nota"}),(0,g.jsx)(v.default,{onPress:t,children:(0,g.jsx)(I.default,{name:"close-outline",size:28,color:"#333"})})]}),(0,g.jsx)(w.default,{showsVerticalScrollIndicator:!1,keyboardShouldPersistTaps:"handled",children:(0,g.jsxs)(C.default,{style:te.formContainer,children:[(0,g.jsx)(C.default,{style:te.inputField,children:(0,g.jsx)(F.default,{style:te.titleInput,value:i,onChangeText:s,placeholder:"T\xedtulo da nota...",placeholderTextColor:"#A0AEC0"})}),(0,g.jsx)(C.default,{style:te.inputField,children:(0,g.jsx)(F.default,{style:te.contentInput,value:c,onChangeText:u,placeholder:"Comece a digitar aqui...",placeholderTextColor:"#A0AEC0",multiline:!0,textAlignVertical:"top"})}),(0,g.jsxs)(C.default,{style:te.rowFields,children:[(0,g.jsx)(C.default,{style:[te.pickerContainerStyle,{flex:1,marginRight:10,zIndex:20}],children:(0,g.jsx)(Y,{label:"Categoria",options:S,selectedValue:f,onValueChange:h})}),(0,g.jsxs)(C.default,{style:{flex:.8,marginLeft:10},children:[(0,g.jsx)(b.default,{style:te.inputLabel,children:"Cor"}),(0,g.jsx)(w.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:te.colorSelectorContainer,children:Z.map((e=>(0,g.jsx)(v.default,{style:[te.colorOption,{backgroundColor:e},e===m&&te.colorOptionSelected],onPress:()=>p(e)},e)))})]})]}),(0,g.jsx)(v.default,{style:[te.confirmButton,x&&te.confirmButtonDisabled],onPress:async()=>{if(i.trim()||c.trim()){y(!0);try{const e=await d.default.getItem("@notes"),a=e?JSON.parse(e):[],n=Date.now();if(j&&r){const e=a.findIndex((e=>e.id===r));e>-1&&(a[e]=Object.assign({},a[e],{title:i.trim(),content:c.trim(),category:f,color:m,updatedAt:n}))}else{const e={id:n.toString(),title:i.trim(),content:c.trim(),category:f,color:m,createdAt:n,updatedAt:n};a.push(e)}await d.default.setItem("@notes",JSON.stringify(a)),D.default.alert("Sucesso",`Nota ${j?"atualizada":"criada"}!`),o(),t()}catch(e){D.default.alert("Erro","N\xe3o foi poss\xedvel salvar a nota.")}finally{y(!1)}}else D.default.alert("Nota Vazia","Adicione um t\xedtulo ou conte\xfado para a nota.")},disabled:x,children:x?(0,g.jsx)(z.default,{color:"#fff"}):(0,g.jsx)(b.default,{style:te.confirmButtonText,children:j?"Salvar Altera\xe7\xf5es":"Criar Nota"})})]})})]})})},te=S.default.create({modal:{justifyContent:"flex-end",margin:0},modalContent:{backgroundColor:"#FFFFFF",paddingTop:15,borderTopRightRadius:25,borderTopLeftRadius:25,maxHeight:"90%",paddingBottom:10},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBottom:15,paddingHorizontal:20,marginBottom:5},modalTitle:{fontSize:22,fontWeight:"bold",color:"#1A202C"},formContainer:{paddingHorizontal:20,paddingBottom:150},inputField:{marginBottom:20},inputLabel:{fontSize:14,color:"#4A5568",marginBottom:8,fontWeight:"500"},titleInput:{fontSize:20,fontWeight:"600",color:"#2D3748",paddingVertical:10,borderBottomWidth:1,borderBottomColor:"#E2E8F0",marginBottom:10},contentInput:{fontSize:16,color:"#4A5568",minHeight:150,textAlignVertical:"top",paddingTop:0,lineHeight:24},rowFields:{flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",marginBottom:25},colorSelectorContainer:{paddingVertical:5,alignItems:"center"},colorOption:{width:32,height:32,borderRadius:16,marginRight:10,borderWidth:2,borderColor:"transparent"},colorOptionSelected:{borderColor:"#4A5568",transform:[{scale:1.1}]},confirmButton:{backgroundColor:"#1D854C",borderRadius:10,height:52,justifyContent:"center",alignItems:"center",marginTop:20,elevation:2},confirmButtonDisabled:{backgroundColor:"#A5D6A7"},confirmButtonText:{color:"#FFFFFF",fontSize:17,fontWeight:"600"},pickerButton:{backgroundColor:"#F7F8FC",borderRadius:10,height:50,paddingHorizontal:15,borderWidth:1,borderColor:"#E2E8F0",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},pickerButtonText:{fontSize:15,color:"#2D3748"},disabledInput:{backgroundColor:"#E5E7EB"},pickerOptionsContainer:{backgroundColor:"#FFFFFF",borderRadius:8,marginTop:4,borderColor:"#E2E8F0",borderWidth:1,elevation:5,zIndex:1e3,position:"absolute",width:"100%",top:55},pickerOption:{paddingVertical:12,paddingHorizontal:15,borderBottomWidth:1,borderBottomColor:"#F3F4F6"}}),oe=({navigation:e})=>{const[t,o]=(0,n.useState)("all"),[a,r]=(0,n.useState)([]),[l,i]=(0,n.useState)(""),[s,c]=(0,n.useState)(!0),[u,f]=(0,n.useState)(!1),[h,m]=(0,n.useState)(null),[p,x]=(0,n.useState)(!1),y=(0,n.useMemo)((()=>[{id:"all",name:"Todas",color:X.find((e=>"geral"===e.id))?.color||"#78909C"},...X]),[]),j=(0,n.useCallback)((async()=>{c(!0);try{const e=await d.default.getItem("@notes"),t=e?JSON.parse(e):[];r(t.sort(((e,t)=>(t.updatedAt||0)-(e.updatedAt||0))))}catch(e){D.default.alert("Erro","N\xe3o foi poss\xedvel carregar suas anota\xe7\xf5es.")}finally{c(!1)}}),[]);(0,n.useEffect)((()=>{j()}),[j]);const S=(0,n.useMemo)((()=>a.filter((e=>{const o="all"===t||e.category===t,a=l.toLowerCase(),n=""===l||e.title&&e.title.toLowerCase().includes(a)||e.content&&e.content.toLowerCase().includes(a);return o&&n}))),[a,t,l]),T=(e=null)=>{m(e),f(!0)};return(0,g.jsxs)(B.default,{style:ae.container,children:[(0,g.jsx)(k.default,{backgroundColor:"#1D854C",barStyle:"light-content"}),(0,g.jsxs)(C.default,{style:ae.header,children:[(0,g.jsx)(v.default,{onPress:()=>e.goBack(),style:ae.headerButton,children:(0,g.jsx)(I.default,{name:"arrow-back-outline",size:26,color:"#FFFFFF"})}),(0,g.jsx)(b.default,{style:ae.headerTitle,children:"Minhas Anota\xe7\xf5es"}),(0,g.jsx)(C.default,{style:{width:38}})]}),(0,g.jsxs)(C.default,{style:ae.searchContainer,children:[(0,g.jsx)(I.default,{name:"search-outline",size:22,color:"#A0AEC0",style:ae.searchIcon}),(0,g.jsx)(F.default,{style:ae.searchInput,placeholder:"Buscar por t\xedtulo ou conte\xfado...",value:l,onChangeText:i}),l?(0,g.jsx)(v.default,{onPress:()=>i(""),style:ae.clearSearchButton,children:(0,g.jsx)(I.default,{name:"close-circle",size:20,color:"#CBD5E0"})}):null]}),(0,g.jsx)(C.default,{children:(0,g.jsx)(w.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:ae.categoriasContainer,children:y.map((e=>(0,g.jsx)(v.default,{style:[ae.categoriaButton,t===e.id&&ae.categoriaButtonActive,t===e.id&&{backgroundColor:`${e.color}33`}],onPress:()=>o(e.id),children:(0,g.jsx)(b.default,{style:[ae.categoriaText,t===e.id&&ae.categoriaTextActive,t===e.id&&{color:e.color}],children:e.name})},e.id)))})}),s?(0,g.jsxs)(C.default,{style:ae.fullScreenLoader,children:[(0,g.jsx)(z.default,{size:"large",color:"#1D854C"}),(0,g.jsx)(b.default,{style:ae.loadingText,children:"Carregando..."})]}):(0,g.jsx)(Q.default,{data:S,renderItem:({item:e})=>{if(!e||!e.id)return null;const t=(o=e.category,X.find((e=>e.id===o))||X.find((e=>"geral"===e.id)));var o;const n=e.color||t.color;return(0,g.jsxs)(v.default,{style:ae.notaCard,activeOpacity:.8,onPress:()=>T(e),children:[(0,g.jsx)(C.default,{style:[ae.colorIndicator,{backgroundColor:n}]}),(0,g.jsxs)(C.default,{style:ae.notaInfo,children:[e.title?(0,g.jsx)(b.default,{style:ae.notaTitle,numberOfLines:1,children:e.title}):null,(0,g.jsx)(b.default,{style:ae.notaContent,numberOfLines:e.title?3:5,children:e.content||"Sem conte\xfado..."}),(0,g.jsxs)(C.default,{style:ae.cardFooter,children:[(0,g.jsx)(C.default,{style:[ae.categoryChip,{backgroundColor:`${t.color}30`}],children:(0,g.jsx)(b.default,{style:[ae.notaCategoryText,{color:t.color}],children:t.name})}),(0,g.jsxs)(C.default,{style:ae.footerActions,children:[(0,g.jsx)(b.default,{style:ae.notaDate,children:new Date(e.updatedAt).toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}),(0,g.jsx)(v.default,{style:ae.deleteButton,onPress:()=>(async e=>{e&&D.default.alert("Confirmar Exclus\xe3o","Tem certeza que deseja excluir esta anota\xe7\xe3o?",[{text:"Cancelar",style:"cancel"},{text:"Excluir",style:"destructive",onPress:async()=>{x(!0);try{const t=a.filter((t=>t.id!==e));await d.default.setItem("@notes",JSON.stringify(t)),r(t),D.default.alert("Sucesso","Anota\xe7\xe3o exclu\xedda.")}catch(t){D.default.alert("Erro","N\xe3o foi poss\xedvel excluir a anota\xe7\xe3o.")}finally{x(!1)}}}],{cancelable:!0})})(e.id),children:(0,g.jsx)(I.default,{name:"trash-outline",size:18,color:"#EF4444"})})]})]})]})]})},keyExtractor:e=>e.id.toString(),contentContainerStyle:ae.notasList,numColumns:2,columnWrapperStyle:ae.row,ListEmptyComponent:()=>(0,g.jsxs)(C.default,{style:ae.emptyStateContainer,children:[(0,g.jsx)(I.default,{name:"reader-outline",size:60,color:"#CBD5E0"}),(0,g.jsx)(b.default,{style:ae.emptyStateText,children:"Nenhuma anota\xe7\xe3o encontrada."}),""===l&&"all"===t&&(0,g.jsx)(b.default,{style:ae.emptyStateSubText,children:"Crie sua primeira anota\xe7\xe3o no bot\xe3o '+'!"})]})}),(0,g.jsx)(v.default,{style:[ae.addButton,p&&ae.buttonDisabled],onPress:()=>!p&&T(),disabled:p,children:p?(0,g.jsx)(z.default,{color:"#FFFFFF"}):(0,g.jsx)(E.default,{name:"add",size:32,color:"#FFFFFF"})}),(0,g.jsx)(ee,{isVisible:u,onClose:()=>{f(!1),m(null)},onNoteSaved:j,existingNote:h})]})},ae=S.default.create({container:{flex:1,backgroundColor:"#F9FAFB"},header:{height:60,backgroundColor:"#1D854C",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:12,elevation:4},headerButton:{padding:10},headerTitle:{fontSize:20,color:"#FFFFFF",fontWeight:"600"},searchContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFFFFF",borderRadius:25,marginHorizontal:16,marginVertical:12,paddingHorizontal:15,height:50,elevation:2,shadowColor:"#000",shadowOpacity:.05,shadowRadius:3},searchIcon:{marginRight:10},searchInput:{flex:1,fontSize:16,color:"#2D3748"},clearSearchButton:{padding:5},categoriasContainer:{paddingHorizontal:16,paddingVertical:12},categoriaButton:{paddingVertical:8,paddingHorizontal:18,borderRadius:20,marginRight:10,backgroundColor:"#E9EDF5",borderWidth:1,borderColor:"transparent"},categoriaButtonActive:{borderColor:"#D1D5DB",shadowColor:"#000",shadowOpacity:.08,shadowRadius:4,elevation:1},categoriaText:{fontSize:14,color:"#4A5568",fontWeight:"500"},categoriaTextActive:{fontWeight:"bold"},fullScreenLoader:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,fontSize:16,color:"#1D854C"},notasList:{paddingHorizontal:12,paddingTop:8,paddingBottom:90},row:{justifyContent:"space-between",paddingHorizontal:4},notaCard:{backgroundColor:"#FFFFFF",borderRadius:12,marginBottom:16,elevation:2,shadowColor:"#000000",shadowOffset:{width:0,height:1},shadowOpacity:.06,shadowRadius:4,width:"48.5%",overflow:"hidden"},colorIndicator:{height:8,width:"100%"},notaInfo:{padding:14},notaTitle:{fontSize:16,fontWeight:"600",color:"#1F2937",marginBottom:6,lineHeight:22},notaContent:{fontSize:14,color:"#4B5563",lineHeight:20,marginBottom:12},cardFooter:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:"auto",paddingTop:8,borderTopWidth:1,borderTopColor:"#F3F4F6"},footerActions:{flexDirection:"row",alignItems:"center"},deleteButton:{marginLeft:8,padding:4},categoryChip:{paddingHorizontal:10,paddingVertical:4,borderRadius:12},notaCategoryText:{fontSize:11,fontWeight:"500",textTransform:"capitalize"},notaDate:{fontSize:11,color:"#9CA3AF"},emptyStateContainer:{flex:1,alignItems:"center",justifyContent:"center",padding:20,marginTop:40,width:"100%"},emptyStateText:{marginTop:16,fontSize:17,fontWeight:"500",color:"#6B7280",textAlign:"center"},emptyStateSubText:{marginTop:8,fontSize:14,color:"#9CA3AF",textAlign:"center",lineHeight:20},addButton:{position:"absolute",right:20,bottom:25,width:60,height:60,borderRadius:30,backgroundColor:"#1D854C",justifyContent:"center",alignItems:"center",elevation:6,shadowColor:"#052e16",shadowOffset:{width:0,height:3},shadowOpacity:.3,shadowRadius:4},buttonDisabled:{backgroundColor:"#A5D6A7"}});var ne=o(61177);const re=({label:e,options:t,selectedValue:o,onValueChange:a,disabled:r})=>{const[l,i]=(0,n.useState)(!1),s=t.find((e=>e.value===o));return(0,g.jsxs)(C.default,{style:[ie.inputField,{zIndex:l?10:1}],children:[(0,g.jsx)(b.default,{style:ie.inputLabel,children:e}),(0,g.jsxs)(v.default,{onPress:()=>!r&&i(!l),style:[ie.pickerButton,r&&ie.disabledInput],children:[(0,g.jsx)(b.default,{style:[ie.pickerButtonText,r&&ie.disabledText],children:s?s.label:"Selecione..."}),(0,g.jsx)(I.default,{name:l?"chevron-up-outline":"chevron-down-outline",size:22,color:r?"#A0AEC0":"#555"})]}),l&&!r&&(0,g.jsx)(C.default,{style:ie.pickerOptionsContainer,children:t.map((e=>(0,g.jsx)(v.default,{style:ie.pickerOption,onPress:()=>{a(e.value),i(!1)},children:(0,g.jsx)(b.default,{children:e.label})},e.value)))})]})},le=({isVisible:e,onClose:t,onTaskSaved:o,existingTask:a})=>{const{userData:r}=x(),[i,s]=(0,n.useState)(null),[d,c]=(0,n.useState)(""),[u,h]=(0,n.useState)(""),[m,p]=(0,n.useState)(new Date),[y,j]=(0,n.useState)(!1),[S,T]=(0,n.useState)("media"),[B,k]=(0,n.useState)("pending"),[A,E]=(0,n.useState)(""),[P,R]=(0,n.useState)([]),[W,L]=(0,n.useState)({}),[O,H]=(0,n.useState)(!1),[N,V]=(0,n.useState)(!1),U=!!a,q=U&&a?.createdByUid===r?.uid,M=N||"completed"===B||"cancelled"===B,G="completed"===B?" (Conclu\xedda)":"cancelled"===B?" (Cancelada)":"";(0,n.useEffect)((()=>{e&&(U&&a?(s(a.id),c(a.title||""),h(a.description||""),p(a.dueDate?new Date(a.dueDate+"T00:00:00"):new Date),T(a.priority||"media"),k(a.status||"pending"),L(a.assignedTo||{})):_(),R([]),E(""))}),[a,e,U]);const _=()=>{s(null),c(""),h("");const e=new Date;e.setDate(e.getDate()+1),p(e),T("media"),k("pending"),E(""),R([]),L({}),V(!1)},J=()=>j(!1),K=e=>{L((t=>{const o=Object.assign({},t);return o[e.id]?delete o[e.id]:o[e.id]={name:e.name,avatarUrl:e.avatarUrl||null},o})),R((t=>t.filter((t=>t.id!==e.id)))),E("")};return(0,g.jsx)($.default,{isVisible:e,onSwipeComplete:M?null:t,swipeDirection:M?[]:["down"],onBackdropPress:M?null:t,onModalHide:_,style:ie.modal,avoidKeyboard:!0,children:(0,g.jsxs)(C.default,{style:ie.modalContent,children:[(0,g.jsxs)(C.default,{style:ie.modalHeader,children:[(0,g.jsx)(b.default,{style:ie.modalTitle,children:U?"Editar Tarefa":"Nova Tarefa"}),(0,g.jsx)(v.default,{onPress:M?null:t,disabled:M,children:(0,g.jsx)(I.default,{name:"close-outline",size:28,color:M?"#A0AEC0":"#333"})})]}),(0,g.jsx)(w.default,{showsVerticalScrollIndicator:!1,keyboardShouldPersistTaps:"handled",children:(0,g.jsxs)(C.default,{style:ie.formContainer,children:[(0,g.jsxs)(C.default,{style:ie.inputField,children:[(0,g.jsxs)(b.default,{style:ie.inputLabel,children:["T\xedtulo da Tarefa *",G]}),(0,g.jsx)(F.default,{style:[ie.input,M&&ie.disabledInput],value:d,onChangeText:c,placeholder:"Ex: Preparar material da aula",editable:!M})]}),(0,g.jsxs)(C.default,{style:ie.inputField,children:[(0,g.jsx)(b.default,{style:ie.inputLabel,children:"Descri\xe7\xe3o (opcional)"}),(0,g.jsx)(F.default,{style:[ie.input,ie.textArea,M&&ie.disabledInput],value:u,onChangeText:h,placeholder:"Adicionar detalhes, subtarefas...",multiline:!0,editable:!M})]}),(0,g.jsxs)(C.default,{style:ie.inputField,children:[(0,g.jsx)(b.default,{style:ie.inputLabel,children:"Prazo de Conclus\xe3o *"}),(0,g.jsxs)(v.default,{onPress:()=>j(!0),style:[ie.datePickerButton,M&&ie.disabledInput],disabled:M,children:[(0,g.jsx)(I.default,{name:"calendar-outline",size:20,color:M?"#A0AEC0":"#4A5568",style:{marginRight:10}}),(0,g.jsx)(b.default,{style:[ie.datePickerText,M&&ie.disabledText],children:m.toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"})})]})]}),(0,g.jsxs)(C.default,{style:ie.rowFields,children:[(0,g.jsx)(C.default,{style:{flex:1,marginRight:U?10:0,zIndex:2},children:(0,g.jsx)(re,{label:"Prioridade",options:[{label:"Alta",value:"alta"},{label:"M\xe9dia",value:"media"},{label:"Baixa",value:"baixa"}],selectedValue:S,onValueChange:T,disabled:M})}),U&&(0,g.jsx)(C.default,{style:{flex:1,marginLeft:10,zIndex:1},children:(0,g.jsx)(re,{label:"Status",options:[{label:"Pendente",value:"pending"},{label:"Em Progresso",value:"in_progress"},{label:"Conclu\xedda",value:"completed"},{label:"Cancelada",value:"cancelled"}],selectedValue:B,onValueChange:k,disabled:!q})})]}),(0,g.jsxs)(C.default,{style:ie.inputField,children:[(0,g.jsx)(b.default,{style:ie.inputLabel,children:"Atribuir para"}),(0,g.jsxs)(C.default,{style:ie.assignedSearchContainer,children:[(0,g.jsx)(F.default,{style:[ie.input,{flex:1,marginRight:8},M&&ie.disabledInput],value:A,onChangeText:E,placeholder:"Buscar por nome...",editable:!M}),(0,g.jsx)(v.default,{onPress:async()=>{if(A.trim().length<3)R([]);else{H(!0);try{const e=(0,l.query)((0,l.ref)(f,"users"),(0,l.orderByChild)("name")),t=await(0,l.get)(e);let o=[];t.exists()&&t.forEach((e=>{const t=e.val();t.name&&t.name.toLowerCase().includes(A.toLowerCase())&&(W[e.key]||o.push({id:e.key,name:t.name,email:t.email,avatarUrl:t.profileImageUrl}))})),R(o)}catch(e){D.default.alert("Erro","Falha ao buscar usu\xe1rios.")}finally{H(!1)}}},style:[ie.searchUserButton,(O||M)&&ie.disabledInput],disabled:O||M,children:O?(0,g.jsx)(z.default,{color:"#fff",size:"small"}):(0,g.jsx)(I.default,{name:"search-outline",size:24,color:M?"#A0AEC0":"#fff"})})]}),P.length>0&&(0,g.jsx)(C.default,{style:ie.foundUsersListContainer,children:(0,g.jsx)(w.default,{nestedScrollEnabled:!0,style:{maxHeight:130},children:P.map((e=>(0,g.jsxs)(v.default,{style:ie.userToAssignItem,onPress:()=>K(e),disabled:M,children:[(0,g.jsxs)(b.default,{style:ie.userToAssignText,children:[e.name," (",e.email,")"]}),(0,g.jsx)(I.default,{name:"square-outline",size:22,color:"#1D854C"})]},e.id)))})}),Object.keys(W).length>0&&(0,g.jsxs)(C.default,{style:ie.assignedUsersChipsContainer,children:[(0,g.jsx)(b.default,{style:ie.assignedUsersTitle,children:"Designado(s):"}),(0,g.jsx)(C.default,{style:ie.chipsWrapper,children:Object.entries(W).map((([e,t])=>(0,g.jsxs)(C.default,{style:ie.assignedUserChip,children:[(0,g.jsx)(b.default,{style:ie.assignedUserName,children:t.name}),(0,g.jsx)(v.default,{onPress:()=>K(Object.assign({id:e},t)),style:{marginLeft:6},disabled:M,children:(0,g.jsx)(I.default,{name:"close-circle-outline",size:18,color:"#D32F2F"})})]},e)))})]})]}),(0,g.jsx)(v.default,{style:[ie.confirmButton,M&&ie.confirmButtonDisabled],onPress:async()=>{if(!d.trim())return void D.default.alert("Erro","T\xedtulo da tarefa \xe9 obrigat\xf3rio.");if(!r||!r.uid)return void D.default.alert("Erro","Usu\xe1rio n\xe3o autenticado.");V(!0);const e={title:d.trim(),description:u.trim(),dueDate:m.toISOString().split("T")[0],priority:S,status:B,assignedTo:W,updatedAt:(0,l.serverTimestamp)()};try{U&&i?(e.createdByUid=a.createdByUid,e.createdByName=a.createdByName,e.createdAt=a.createdAt,await(0,l.update)((0,l.ref)(f,`tasks/${i}`),e),D.default.alert("Sucesso","Tarefa atualizada!")):(e.createdByUid=r.uid,e.createdByName=r.name||"Desconhecido",e.createdAt=(0,l.serverTimestamp)(),await(0,l.push)((0,l.ref)(f,"tasks"),e),D.default.alert("Sucesso","Tarefa criada!")),o&&o(),t()}catch(n){D.default.alert("Erro",`N\xe3o foi poss\xedvel ${U?"atualizar":"criar"} a tarefa.`)}finally{V(!1)}},disabled:M,children:N?(0,g.jsx)(z.default,{color:"#fff"}):(0,g.jsx)(b.default,{style:ie.confirmButtonText,children:U?"Salvar Altera\xe7\xf5es":"Criar Tarefa"})})]})}),(0,g.jsx)(ne.default,{isVisible:y,mode:"date",date:m,onConfirm:e=>{p(e),J()},onCancel:J,minimumDate:new Date((new Date).setDate((new Date).getDate()-1))})]})})},ie=S.default.create({modal:{justifyContent:"flex-end",margin:0},modalContent:{backgroundColor:"#FFFFFF",paddingTop:15,borderTopRightRadius:25,borderTopLeftRadius:25,maxHeight:"90%",paddingBottom:10},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBottom:15,paddingHorizontal:20,marginBottom:10},modalTitle:{fontSize:22,fontWeight:"bold",color:"#1F2937"},formContainer:{paddingHorizontal:20,paddingBottom:20},inputField:{marginBottom:20},inputLabel:{fontSize:15,color:"#4A5568",marginBottom:8,fontWeight:"500"},input:{backgroundColor:"#F7F8FC",borderRadius:10,minHeight:52,paddingHorizontal:15,fontSize:16,color:"#2D3748",borderWidth:1,borderColor:"#E2E8F0",paddingVertical:12},disabledInput:{backgroundColor:"#E5E7EB"},disabledText:{color:"#9CA3AF"},textArea:{textAlignVertical:"top",paddingTop:15,height:100},datePickerButton:{flexDirection:"row",alignItems:"center",backgroundColor:"#F7F8FC",borderRadius:10,height:52,paddingHorizontal:15,borderWidth:1,borderColor:"#E2E8F0"},datePickerText:{fontSize:16,color:"#2D3748"},rowFields:{flexDirection:"row",justifyContent:"space-between",marginBottom:10},confirmButton:{backgroundColor:"#1D854C",borderRadius:10,height:52,justifyContent:"center",alignItems:"center",marginTop:25,elevation:2},confirmButtonDisabled:{backgroundColor:"#A5D6A7"},confirmButtonText:{color:"#FFFFFF",fontSize:17,fontWeight:"600"},pickerButton:{backgroundColor:"#F7F8FC",borderRadius:10,height:52,paddingHorizontal:15,borderWidth:1,borderColor:"#E2E8F0",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},pickerButtonText:{fontSize:16,color:"#2D3748"},pickerOptionsContainer:{backgroundColor:"#FFFFFF",borderRadius:8,marginTop:4,borderColor:"#E2E8F0",borderWidth:1,elevation:5,zIndex:10,position:"absolute",width:"100%",top:80},pickerOption:{paddingVertical:12,paddingHorizontal:15,borderBottomWidth:1,borderBottomColor:"#F3F4F6"},assignedSearchContainer:{flexDirection:"row",alignItems:"center",marginBottom:10},searchUserButton:{backgroundColor:"#1D854C",paddingHorizontal:14,borderRadius:8,justifyContent:"center",alignItems:"center",height:52},foundUsersListContainer:{borderColor:"#E2E8F0",borderWidth:1,borderRadius:8,backgroundColor:"#fff",marginTop:8},userToAssignItem:{paddingVertical:10,paddingHorizontal:12,borderBottomWidth:1,borderBottomColor:"#F3F4F6",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},userToAssignText:{fontSize:15,color:"#374151"},assignedUsersChipsContainer:{marginTop:15},assignedUsersTitle:{fontSize:14,fontWeight:"600",color:"#10502F",marginBottom:10},chipsWrapper:{flexDirection:"row",flexWrap:"wrap"},assignedUserChip:{flexDirection:"row",alignItems:"center",backgroundColor:"#E0F2FE",borderRadius:16,paddingVertical:6,paddingHorizontal:12,marginRight:8,marginBottom:8},assignedUserName:{color:"#0C4A6E",fontWeight:"500",fontSize:14}}),se=e=>{switch(e){case"pending":return{color:"#60A5FA",label:"Pendente",icon:"hourglass-outline"};case"in_progress":return{color:"#FBBF24",label:"Em Progresso",icon:"sync-circle-outline"};case"completed":return{color:"#34D399",label:"Conclu\xedda",icon:"checkmark-done-circle-outline"};case"cancelled":return{color:"#F87171",label:"Cancelada",icon:"close-circle-outline"};default:return{color:"#9CA3AF",label:"Todas",icon:"list-outline"}}},de=({navigation:e})=>{const{userData:t}=x(),[o,a]=(0,n.useState)("pending"),[r,i]=(0,n.useState)([]),[s,d]=(0,n.useState)(!0),[c,u]=(0,n.useState)(!1),[h,m]=(0,n.useState)(null),[p,y]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(!t||!t.uid)return d(!1),void i([]);d(!0);const e=(0,l.query)((0,l.ref)(f,"tasks"),(0,l.orderByChild)("createdAt")),o=(0,l.onValue)(e,(e=>{const o=[];e.exists()&&e.forEach((e=>{const a=Object.assign({id:e.key},e.val());(a.createdByUid===t.uid||a.assignedTo&&a.assignedTo[t.uid])&&o.push(a)})),i(o.sort(((e,t)=>(t.createdAt||0)-(e.createdAt||0)))),d(!1)}),(e=>{D.default.alert("Erro","N\xe3o foi poss\xedvel carregar as tarefas."),d(!1)}));return()=>o()}),[t]);const j=(0,n.useMemo)((()=>"all"===o?r.filter((e=>"cancelled"!==e.status)):r.filter((e=>e.status===o))),[r,o]),F=(e=null)=>{m(e),u(!0)};return(0,g.jsxs)(B.default,{style:ce.container,children:[(0,g.jsx)(k.default,{backgroundColor:"#1D854C",barStyle:"light-content"}),(0,g.jsxs)(C.default,{style:ce.header,children:[(0,g.jsx)(v.default,{onPress:()=>e.goBack(),style:ce.headerButton,children:(0,g.jsx)(I.default,{name:"arrow-back-outline",size:26,color:"#FFFFFF"})}),(0,g.jsx)(b.default,{style:ce.headerTitle,children:"Gerenciar Tarefas"}),(0,g.jsx)(C.default,{style:{width:38}})]}),(0,g.jsx)(C.default,{style:ce.viewTypeContainer,children:["pending","in_progress","completed","all"].map((e=>(0,g.jsx)(v.default,{style:[ce.viewTypeButton,o===e&&ce.viewTypeButtonActive],onPress:()=>a(e),children:(0,g.jsx)(b.default,{style:[ce.viewTypeText,o===e&&ce.viewTypeTextActive],children:se(e).label})},e)))}),s&&!j.length?(0,g.jsxs)(C.default,{style:ce.fullScreenLoader,children:[(0,g.jsx)(z.default,{size:"large",color:"#1D854C"}),(0,g.jsx)(b.default,{style:ce.loadingText,children:"Carregando tarefas..."})]}):(0,g.jsx)(Q.default,{data:j,renderItem:({item:e})=>{const o=(e=>{switch(e){case"alta":return{color:"#EF4444",name:"arrow-up-circle-outline"};case"media":return{color:"#F59E0B",name:"ellipse-outline"};case"baixa":return{color:"#10B981",name:"arrow-down-circle-outline"};default:return{color:"#6B7280",name:"remove-circle-outline"}}})(e.priority),a=se(e.status),n=e.createdByUid===t?.uid||e.assignedTo&&e.assignedTo[t.uid],r=e.createdByUid===t?.uid,i="cancelled"===e.status,s="completed"===e.status;return(0,g.jsxs)(v.default,{style:[ce.tarefaCard,(s||i)&&ce.tarefaCardDisabled],activeOpacity:.8,onPress:()=>F(e),onLongPress:r?()=>(async e=>{e&&e.createdByUid===t?.uid?D.default.alert("Confirmar Exclus\xe3o",`Excluir a tarefa "${e.title}"?`,[{text:"Cancelar",style:"cancel"},{text:"Excluir",style:"destructive",onPress:async()=>{y(!0);try{await(0,l.remove)((0,l.ref)(f,`tasks/${e.id}`)),D.default.alert("Sucesso","Tarefa exclu\xedda.")}catch(t){D.default.alert("Erro","N\xe3o foi poss\xedvel excluir a tarefa.")}finally{y(!1)}}}],{cancelable:!0}):D.default.alert("A\xe7\xe3o n\xe3o permitida","Voc\xea s\xf3 pode excluir tarefas que voc\xea criou.")})(e):null,children:[(0,g.jsxs)(C.default,{style:ce.cardHeader,children:[(0,g.jsx)(v.default,{style:ce.statusIndicatorButton,onPress:()=>n&&(async e=>{if(!e||!e.id)return;let t;if("pending"===e.status)t="in_progress";else if("in_progress"===e.status)t="completed";else{if("completed"!==e.status)return;t="pending"}try{await(0,l.update)((0,l.ref)(f,`tasks/${e.id}`),{status:t,updatedAt:(0,l.serverTimestamp)()})}catch(o){D.default.alert("Erro","Falha ao atualizar status.")}})(e),disabled:!n||p||i,children:(0,g.jsx)(I.default,{name:a.icon,size:26,color:n?a.color:"#B0BEC5"})}),(0,g.jsx)(b.default,{style:[ce.tarefaTitle,(s||i)&&ce.tarefaTitleDisabled],numberOfLines:2,children:e.title}),(0,g.jsx)(C.default,{style:[ce.priorityIndicator,{borderColor:o.color,backgroundColor:`${o.color}20`}],children:(0,g.jsx)(I.default,{name:o.name,size:18,color:o.color})})]}),e.description?(0,g.jsx)(b.default,{style:ce.tarefaDescription,numberOfLines:2,children:e.description}):null,(0,g.jsxs)(C.default,{style:ce.cardFooter,children:[(0,g.jsxs)(C.default,{style:ce.dueDateContainer,children:[(0,g.jsx)(I.default,{name:"calendar-outline",size:15,color:"#6B7280"}),(0,g.jsxs)(b.default,{style:ce.tarefaDueDate,children:["Prazo: ",e.dueDate?new Date(e.dueDate+"T00:00:00").toLocaleDateString("pt-BR"):"N/A"]})]}),e.assignedTo&&Object.keys(e.assignedTo).length>0&&(0,g.jsxs)(C.default,{style:ce.assignedAvatarsContainer,children:[Object.entries(e.assignedTo).slice(0,3).map((([e,t],o)=>(0,g.jsx)(C.default,{style:[ce.avatarSmall,{zIndex:3-o,marginLeft:o>0?-8:0}],children:t.avatarUrl?(0,g.jsx)(T.default,{source:{uri:t.avatarUrl},style:ce.avatarImage}):(0,g.jsx)(b.default,{style:ce.avatarInitial,children:t.name?t.name.charAt(0).toUpperCase():"?"})},e))),Object.keys(e.assignedTo).length>3&&(0,g.jsxs)(b.default,{style:ce.moreAssignees,children:["+",Object.keys(e.assignedTo).length-3]})]})]})]})},keyExtractor:e=>e.id.toString(),contentContainerStyle:ce.tarefasList,ListEmptyComponent:()=>{const e="all"===o?"tarefas ativas":se(o).label.toLowerCase();return(0,g.jsxs)(C.default,{style:ce.emptyStateContainer,children:[(0,g.jsx)(I.default,{name:"file-tray-stacked-outline",size:60,color:"#CBD5E0"}),(0,g.jsx)(b.default,{style:ce.emptyStateText,children:"Nenhuma tarefa encontrada"}),(0,g.jsx)(b.default,{style:ce.emptyStateSubText,children:0===r.length?"Crie a primeira tarefa no bot\xe3o '+'.":`N\xe3o h\xe1 ${e} no momento.`})]})}}),(0,g.jsx)(v.default,{style:[ce.addButton,p&&ce.buttonDisabled],onPress:()=>!p&&F(),disabled:p,children:p?(0,g.jsx)(z.default,{color:"#FFFFFF"}):(0,g.jsx)(E.default,{name:"add",size:32,color:"#FFFFFF"})}),(0,g.jsx)(le,{isVisible:c,onClose:()=>{u(!1),m(null)},onTaskSaved:()=>{},existingTask:h})]})},ce=S.default.create({container:{flex:1,backgroundColor:"#F9FAFB"},header:{height:60,backgroundColor:"#1D854C",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:12,elevation:4},headerButton:{padding:10},headerTitle:{fontSize:20,color:"#FFFFFF",fontWeight:"600"},viewTypeContainer:{flexDirection:"row",justifyContent:"space-around",paddingVertical:12,paddingHorizontal:10,backgroundColor:"#FFFFFF",borderBottomWidth:1,borderBottomColor:"#E5E7EB"},viewTypeButton:{paddingVertical:8,paddingHorizontal:12,borderRadius:20,backgroundColor:"#F3F4F6"},viewTypeButtonActive:{backgroundColor:"#D1FAE5"},viewTypeText:{fontSize:14,color:"#374151",fontWeight:"500"},viewTypeTextActive:{color:"#065F46",fontWeight:"600"},fullScreenLoader:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,fontSize:16,color:"#1D854C"},tarefasList:{paddingHorizontal:16,paddingTop:16,paddingBottom:90},tarefaCard:{backgroundColor:"#FFFFFF",borderRadius:12,padding:16,marginBottom:16,elevation:2,shadowColor:"#000000",shadowOffset:{width:0,height:1},shadowOpacity:.07,shadowRadius:4},tarefaCardDisabled:{backgroundColor:"#F9FAFB"},cardHeader:{flexDirection:"row",alignItems:"center",marginBottom:10},statusIndicatorButton:{paddingRight:10},tarefaTitle:{flex:1,fontSize:17,fontWeight:"600",color:"#1F2937"},tarefaTitleDisabled:{textDecorationLine:"line-through",color:"#9CA3AF",fontWeight:"500"},priorityIndicator:{marginLeft:10,padding:6,borderRadius:18,borderWidth:1.5},tarefaDescription:{fontSize:14,color:"#4B5563",marginBottom:12,lineHeight:20},cardFooter:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingTop:10,borderTopWidth:1,borderTopColor:"#F3F4F6"},dueDateContainer:{flexDirection:"row",alignItems:"center"},tarefaDueDate:{fontSize:13,color:"#6B7280",marginLeft:6},assignedAvatarsContainer:{flexDirection:"row",alignItems:"center"},avatarSmall:{width:30,height:30,borderRadius:15,backgroundColor:"#E0E7FF",justifyContent:"center",alignItems:"center",borderWidth:1.5,borderColor:"#FFFFFF"},avatarImage:{width:"100%",height:"100%",borderRadius:15},avatarInitial:{color:"#4338CA",fontSize:13,fontWeight:"bold"},moreAssignees:{fontSize:12,color:"#6B7280",marginLeft:-4,backgroundColor:"#F3F4F6",paddingHorizontal:6,paddingVertical:3,borderRadius:10},emptyStateContainer:{flex:1,alignItems:"center",justifyContent:"center",padding:20,marginTop:40},emptyStateText:{marginTop:16,fontSize:17,fontWeight:"500",color:"#6B7280",textAlign:"center"},emptyStateSubText:{marginTop:8,fontSize:14,color:"#9CA3AF",textAlign:"center",lineHeight:20},addButton:{position:"absolute",right:20,bottom:25,width:60,height:60,borderRadius:30,backgroundColor:"#1D854C",justifyContent:"center",alignItems:"center",elevation:6,shadowColor:"#052e16",shadowOffset:{width:0,height:3},shadowOpacity:.3,shadowRadius:4},buttonDisabled:{backgroundColor:"#A5D6A7"}});var ue=o(38076),fe=o(31723);const he=({tags:e,onTagsChange:t,disabled:o})=>{const[a,r]=(0,n.useState)(""),l=()=>{a.trim()&&!e.includes(a.trim().toLowerCase())&&(t([...e,a.trim().toLowerCase()]),r(""))};return(0,g.jsxs)(C.default,{children:[(0,g.jsxs)(C.default,{style:me.tagInputContainer,children:[(0,g.jsx)(F.default,{style:[me.input,{flex:1,marginRight:10,backgroundColor:o?"#E5E7EB":"#F7F8FC"}],value:a,onChangeText:r,placeholder:"Adicionar tag (ex: relat\xf3rio)",placeholderTextColor:"#A0AEC0",onSubmitEditing:l,returnKeyType:"done",editable:!o}),(0,g.jsx)(v.default,{onPress:l,style:me.addTagButton,disabled:o,children:(0,g.jsx)(I.default,{name:"add-circle-outline",size:28,color:o?"#A0AEC0":"#1D854C"})})]}),(0,g.jsx)(C.default,{style:me.tagsDisplayContainer,children:e.map((a=>(0,g.jsxs)(C.default,{style:me.tagChip,children:[(0,g.jsx)(b.default,{style:me.tagText,children:a}),(0,g.jsx)(v.default,{onPress:()=>{return!o&&(n=a,void t(e.filter((e=>e!==n))));var n},style:{marginLeft:5},disabled:o,children:(0,g.jsx)(I.default,{name:"close-circle",size:18,color:"#FFFFFF"})})]},a)))})]})},ge=({isVisible:e,onClose:t,onFileSaved:o,existingFile:a})=>{const{userData:r}=x(),[i,d]=(0,n.useState)(null),[c,u]=(0,n.useState)(""),[m,p]=(0,n.useState)(""),[y,j]=(0,n.useState)([]),[S,T]=(0,n.useState)(null),[B,k]=(0,n.useState)(null),[A,E]=(0,n.useState)(""),[P,R]=(0,n.useState)(0),[W,L]=(0,n.useState)(!1),[O,H]=(0,n.useState)(!1),[N,V]=(0,n.useState)(""),[U,q]=(0,n.useState)([]),[M,G]=(0,n.useState)({}),[_,J]=(0,n.useState)(!1),K=!!a;(0,n.useEffect)((()=>{if(e){if(K&&a){d(a.id),u(a.title||""),p(a.description||""),j(a.tags||[]),T(null),k(a.fileUrl),E(a.fileName||"Arquivo existente");const e={};a.permissions&&Object.entries(a.permissions).forEach((([t,o])=>{e[t]=o})),G(e)}else Q();q([]),V(""),R(0),L(!1)}}),[e,a,K,r]);const Q=()=>{d(null),u(""),p(""),j([]),T(null),k(null),E(""),R(0),L(!1),H(!1),V(""),q([]),r&&r.uid&&r.name?G({[r.uid]:{name:r.name,type:"owner"}}):G({})},Y=e=>{G((t=>{const o=Object.assign({},t);return o[e.id]?"owner"!==t[e.id]?.type&&delete o[e.id]:o[e.id]={name:e.name,type:"view"},o})),q((t=>t.filter((t=>t.id!==e.id)))),V("")},X=K?"Salvar Altera\xe7\xf5es":"Adicionar Arquivo",Z=W||O;return(0,g.jsx)($.default,{isVisible:e,onSwipeComplete:Z?null:t,swipeDirection:Z?[]:["down"],onBackdropPress:Z?null:t,onModalHide:Q,style:me.modal,avoidKeyboard:!0,children:(0,g.jsxs)(C.default,{style:me.modalContent,children:[(0,g.jsxs)(C.default,{style:me.modalHeader,children:[(0,g.jsx)(b.default,{style:me.modalTitle,children:K?"Editar Documento":"Novo Documento"}),(0,g.jsx)(v.default,{onPress:Z?null:t,disabled:Z,children:(0,g.jsx)(I.default,{name:"close-outline",size:28,color:Z?"#A0AEC0":"#333"})})]}),(0,g.jsx)(w.default,{showsVerticalScrollIndicator:!1,keyboardShouldPersistTaps:"handled",children:(0,g.jsxs)(C.default,{style:me.formContainer,children:[(0,g.jsxs)(C.default,{style:me.inputField,children:[(0,g.jsx)(b.default,{style:me.inputLabel,children:"T\xedtulo do Documento *"}),(0,g.jsx)(F.default,{style:[me.input,Z&&me.disabledBg],value:c,onChangeText:u,placeholder:"Ex: Relat\xf3rio Semestral",editable:!Z})]}),(0,g.jsxs)(C.default,{style:me.inputField,children:[(0,g.jsx)(b.default,{style:me.inputLabel,children:"Descri\xe7\xe3o (opcional)"}),(0,g.jsx)(F.default,{style:[me.input,me.textArea,Z&&me.disabledBg],value:m,onChangeText:p,placeholder:"Detalhes sobre o arquivo...",multiline:!0,numberOfLines:3,editable:!Z})]}),(0,g.jsxs)(C.default,{style:me.inputField,children:[(0,g.jsx)(b.default,{style:me.inputLabel,children:"Tags"}),(0,g.jsx)(he,{tags:y,onTagsChange:j,disabled:Z})]}),(0,g.jsxs)(C.default,{style:me.inputField,children:[(0,g.jsx)(b.default,{style:me.inputLabel,children:K&&A&&!S?"Arquivo Atual":"Selecionar Arquivo *"}),(0,g.jsxs)(v.default,{onPress:async()=>{if(!W&&!O)try{const e=await fe.getDocumentAsync({type:"*/*",copyToCacheDirectory:!0});if(!e.canceled&&e.assets&&e.assets.length>0){const t=e.assets[0];if(t.size>15728640)return D.default.alert("Arquivo Muito Grande","Selecione um arquivo menor que 15MB."),void T(null);T(t),E(""),k(null)}}catch(e){D.default.alert("Erro","N\xe3o foi poss\xedvel selecionar o arquivo.")}},style:[me.filePickerButton,Z&&me.disabledBg],disabled:Z,children:[(0,g.jsx)(I.default,{name:"document-attach-outline",size:22,color:S||B?"#1D854C":Z?"#A0AEC0":"#555"}),(0,g.jsx)(b.default,{style:[me.filePickerText,(S||B)&&me.filePickerTextSelected,Z&&me.disabledText],children:S?S.name:A||"Clique para selecionar"})]}),S&&!W&&(0,g.jsx)(v.default,{onPress:()=>!Z&&T(null),style:me.removeFileButton,disabled:Z,children:(0,g.jsx)(b.default,{style:[me.removeFileText,Z&&me.disabledText],children:"Limpar"})}),W&&(0,g.jsxs)(C.default,{style:me.uploadProgressContainer,children:[(0,g.jsxs)(b.default,{style:me.uploadProgressText,children:["Enviando: ",P,"%"]}),(0,g.jsx)(C.default,{style:me.progressBarBackground,children:(0,g.jsx)(C.default,{style:[me.progressBarForeground,{width:`${P}%`}]})})]})]}),(0,g.jsxs)(C.default,{style:me.inputField,children:[(0,g.jsx)(b.default,{style:me.inputLabel,children:"Permiss\xf5es de Acesso"}),(0,g.jsxs)(C.default,{style:me.guestSearchContainer,children:[(0,g.jsx)(F.default,{style:[me.input,{flex:1,marginRight:8},Z&&me.disabledBg],value:N,onChangeText:V,placeholder:"Buscar usu\xe1rio por nome...",editable:!Z}),(0,g.jsx)(v.default,{onPress:async()=>{if(N.trim().length<3)q([]);else{J(!0);try{const e=(0,l.query)((0,l.ref)(f,"users"),(0,l.orderByChild)("name")),t=await(0,l.get)(e);let o=[];t.exists()&&t.forEach((e=>{const t=e.val();t.name&&t.name.toLowerCase().includes(N.toLowerCase())&&(e.key===r.uid||M[e.key]||o.push({id:e.key,name:t.name,email:t.email}))})),q(o)}catch(e){D.default.alert("Erro","Falha ao buscar usu\xe1rios.")}finally{J(!1)}}},style:[me.searchButton,Z&&me.disabledBg],disabled:_||Z,children:_?(0,g.jsx)(z.default,{color:"#fff",size:"small"}):(0,g.jsx)(I.default,{name:"search-outline",size:24,color:Z?"#A0AEC0":"#fff"})})]}),U.length>0&&(0,g.jsx)(C.default,{style:me.foundUsersList,children:(0,g.jsx)(w.default,{nestedScrollEnabled:!0,style:{maxHeight:120},children:U.map((e=>(0,g.jsxs)(v.default,{style:me.userItem,onPress:()=>Y(e),disabled:Z,children:[(0,g.jsxs)(b.default,{style:me.userItemText,children:[e.name," (",e.email,")"]}),(0,g.jsx)(I.default,{name:"square-outline",size:22,color:"#1D854C"})]},e.id)))})}),Object.keys(M).length>0&&(0,g.jsxs)(C.default,{style:me.selectedPermissionsContainer,children:[(0,g.jsx)(b.default,{style:me.selectedPermissionsTitle,children:"Acesso Permitido para:"}),(0,g.jsx)(C.default,{style:me.chipsWrapper,children:Object.entries(M).map((([e,t])=>(0,g.jsxs)(C.default,{style:me.selectedPermissionChip,children:[(0,g.jsx)(b.default,{style:me.selectedPermissionName,children:t.name}),(0,g.jsxs)(b.default,{style:me.selectedPermissionType,children:["(","owner"===t.type?"Prop.":"Ver",")"]}),"owner"!==t.type&&(0,g.jsx)(v.default,{onPress:()=>Y({id:e,name:t.name}),style:{marginLeft:6},disabled:Z,children:(0,g.jsx)(I.default,{name:"close-circle-outline",size:18,color:"#D32F2F"})})]},e)))})]})]}),(0,g.jsx)(v.default,{style:[me.confirmButton,Z&&me.confirmButtonDisabled],onPress:async()=>{if(!c.trim())return void D.default.alert("Erro","T\xedtulo \xe9 obrigat\xf3rio.");if(!K&&!S)return void D.default.alert("Erro","Selecione um arquivo.");if(!r||!r.uid)return void D.default.alert("Erro","Usu\xe1rio n\xe3o autenticado.");H(!0);const e={title:c.trim(),description:m.trim(),tags:y,permissions:M,updatedAt:(0,l.serverTimestamp)()},n=async e=>{try{K&&i?(await(0,l.update)((0,l.ref)(f,`sharedFiles/${i}`),e),D.default.alert("Sucesso","Arquivo atualizado!")):(e.uploadedByUid=r.uid,e.uploadedByName=r.name||"Desconhecido",e.createdAt=(0,l.serverTimestamp)(),await(0,l.push)((0,l.ref)(f,"sharedFiles"),e),D.default.alert("Sucesso","Arquivo enviado!")),o&&o(),t()}catch(a){D.default.alert("Erro",`N\xe3o foi poss\xedvel ${K?"atualizar":"enviar"} o arquivo.`)}finally{H(!1),L(!1)}};if(S){L(!0),R(0);try{const t=await fetch(S.uri),o=await t.blob();if(K&&a?.fileStoragePath)try{await(0,s.deleteObject)((0,s.ref)(h,a.fileStoragePath))}catch(d){console.warn("Falha ao deletar arquivo antigo:",d)}const l=S.name.split(".").pop(),i=`sharedFiles/${r.uid}/${Date.now()}_${c.replace(/\s+/g,"_")||"arquivo"}.${l}`,u=(0,s.ref)(h,i),f=(0,s.uploadBytesResumable)(u,o,{contentType:S.mimeType});f.on("state_changed",(e=>R(Math.round(e.bytesTransferred/e.totalBytes*100))),(e=>{D.default.alert("Erro de Upload","Falha no envio."),L(!1),H(!1)}),(async()=>{e.fileUrl=await(0,s.getDownloadURL)(f.snapshot.ref),e.fileName=S.name,e.fileType=S.mimeType||"application/octet-stream",e.fileSize=S.size,e.fileStoragePath=i,await n(e)}))}catch(u){D.default.alert("Erro","Falha ao preparar o envio."),H(!1),L(!1)}}else K?(e.fileUrl=a.fileUrl,e.fileName=a.fileName,e.fileType=a.fileType,e.fileSize=a.fileSize,e.fileStoragePath=a.fileStoragePath,e.uploadedByUid=a.uploadedByUid,e.uploadedByName=a.uploadedByName,e.createdAt=a.createdAt,await n(e)):H(!1)},disabled:Z,children:W||O?(0,g.jsx)(z.default,{color:"#fff"}):(0,g.jsx)(b.default,{style:me.confirmButtonText,children:X})}),K&&a.uploadedByUid===r?.uid&&(0,g.jsxs)(v.default,{style:[me.deleteButton,Z&&me.confirmButtonDisabled],onPress:()=>{K&&i&&a.uploadedByUid===r?.uid&&D.default.alert("Confirmar Exclus\xe3o",`Tem certeza que deseja excluir o arquivo "${c}"? Esta a\xe7\xe3o n\xe3o pode ser desfeita.`,[{text:"Cancelar",style:"cancel"},{text:"Excluir",style:"destructive",onPress:async()=>{H(!0);try{a.fileStoragePath&&await(0,s.deleteObject)((0,s.ref)(h,a.fileStoragePath)),await(0,l.remove)((0,l.ref)(f,`sharedFiles/${i}`)),D.default.alert("Sucesso","Arquivo exclu\xeddo."),t()}catch(e){D.default.alert("Erro","N\xe3o foi poss\xedvel excluir o arquivo.")}finally{H(!1)}}}])},disabled:Z,children:[(0,g.jsx)(I.default,{name:"trash-outline",size:20,color:"#b91c1c"}),(0,g.jsx)(b.default,{style:me.deleteButtonText,children:"Excluir Documento"})]})]})})]})})},me=S.default.create({modal:{justifyContent:"flex-end",margin:0},modalContent:{backgroundColor:"#FFFFFF",paddingTop:15,borderTopRightRadius:25,borderTopLeftRadius:25,maxHeight:"90%",paddingBottom:10},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBottom:15,paddingHorizontal:20,marginBottom:10},modalTitle:{fontSize:22,fontWeight:"bold",color:"#1F2937"},formContainer:{paddingHorizontal:20,paddingBottom:20},inputField:{marginBottom:20},inputLabel:{fontSize:15,color:"#4A5568",marginBottom:8,fontWeight:"500"},input:{backgroundColor:"#F7F8FC",borderRadius:10,minHeight:52,paddingHorizontal:15,fontSize:16,color:"#2D3748",borderWidth:1,borderColor:"#E2E8F0",paddingVertical:12},disabledBg:{backgroundColor:"#E5E7EB"},disabledText:{color:"#9CA3AF"},textArea:{textAlignVertical:"top",paddingTop:15,height:100},filePickerButton:{flexDirection:"row",alignItems:"center",backgroundColor:"#F0F4FF",borderRadius:10,paddingVertical:15,paddingHorizontal:15,borderWidth:1,borderColor:"#D6E0FF",justifyContent:"center"},filePickerText:{fontSize:16,color:"#4A5C9B",marginLeft:10,flexShrink:1},filePickerTextSelected:{color:"#1D854C",fontWeight:"500"},removeFileButton:{marginTop:10,alignSelf:"flex-end"},removeFileText:{color:"#EF4444",fontSize:14,fontWeight:"500"},uploadProgressContainer:{marginTop:12},uploadProgressText:{fontSize:13,color:"#374151",marginBottom:6,textAlign:"center"},progressBarBackground:{height:10,backgroundColor:"#E5E7EB",borderRadius:5,overflow:"hidden"},progressBarForeground:{height:"100%",backgroundColor:"#1D854C",borderRadius:5},confirmButton:{backgroundColor:"#1D854C",borderRadius:10,height:52,justifyContent:"center",alignItems:"center",marginTop:25,elevation:2},confirmButtonDisabled:{backgroundColor:"#A5D6A7"},confirmButtonText:{color:"#FFFFFF",fontSize:17,fontWeight:"600"},deleteButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",borderRadius:10,height:50,borderWidth:1.5,marginBottom:12,marginTop:15,borderColor:"#dc2626",backgroundColor:"#fef2f2"},deleteButtonText:{marginLeft:8,fontSize:16,fontWeight:"600",color:"#b91c1c"},tagInputContainer:{flexDirection:"row",alignItems:"center",marginBottom:10},addTagButton:{padding:6},tagsDisplayContainer:{flexDirection:"row",flexWrap:"wrap"},tagChip:{flexDirection:"row",backgroundColor:"#1D854C",borderRadius:16,paddingVertical:7,paddingHorizontal:12,marginRight:8,marginBottom:8,alignItems:"center"},tagText:{color:"#FFFFFF",fontSize:13,fontWeight:"500"},guestSearchContainer:{flexDirection:"row",alignItems:"center",marginBottom:12},searchButton:{backgroundColor:"#1D854C",paddingHorizontal:14,borderRadius:8,justifyContent:"center",alignItems:"center",height:52},foundUsersList:{borderColor:"#E2E8F0",borderWidth:1,borderRadius:8,backgroundColor:"#fff",marginTop:8},userItem:{paddingVertical:10,paddingHorizontal:12,borderBottomWidth:1,borderBottomColor:"#F3F4F6",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},userItemText:{fontSize:15,color:"#374151"},selectedPermissionsContainer:{marginTop:15,padding:12,backgroundColor:"#E8F5E9",borderRadius:8},selectedPermissionsTitle:{fontSize:14,fontWeight:"600",color:"#10502F",marginBottom:10},chipsWrapper:{flexDirection:"row",flexWrap:"wrap"},selectedPermissionChip:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFFFFF",borderRadius:16,paddingVertical:6,paddingHorizontal:12,marginRight:8,marginBottom:8,borderWidth:1,borderColor:"#A7F3D0",alignSelf:"flex-start"},selectedPermissionName:{color:"#065F46",fontWeight:"500",fontSize:14},selectedPermissionType:{color:"#047857",fontSize:12,marginLeft:4}}),pe=(e,t=2)=>{if(!e||0===e)return"0 Bytes";const o=t<0?0:t,a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(o))+" "+["Bytes","KB","MB","GB","TB"][a]},xe=({navigation:e})=>{const{userData:t}=x(),[o,a]=(0,n.useState)("meusArquivos"),[r,i]=(0,n.useState)([]),[s,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(!0),[h,m]=(0,n.useState)(!1),[p,y]=(0,n.useState)(null),[j,F]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(!t||!t.uid)return u(!1),i([]),void d([]);u(!0);const e=(0,l.query)((0,l.ref)(f,"sharedFiles"),(0,l.orderByChild)("uploadedAt")),o=(0,l.onValue)(e,(e=>{const o=[],a=[];e.exists()&&e.forEach((e=>{const n=Object.assign({id:e.key},e.val());n.uploadedByUid===t.uid?o.push(n):n.permissions&&n.permissions[t.uid]&&n.uploadedByUid!==t.uid&&a.push(n)})),i(o.sort(((e,t)=>(t.uploadedAt||0)-(e.uploadedAt||0)))),d(a.sort(((e,t)=>(t.uploadedAt||0)-(e.uploadedAt||0)))),u(!1)}),(e=>{console.error("Erro ao carregar arquivos:",e),D.default.alert("Erro","N\xe3o foi poss\xedvel carregar os arquivos."),u(!1)}));return()=>o()}),[t]);const S=(e=null)=>{y(e),m(!0)},T="meusArquivos"===o?r:s;return(0,g.jsxs)(B.default,{style:ye.container,children:[(0,g.jsx)(k.default,{backgroundColor:"#1D854C",barStyle:"light-content"}),(0,g.jsxs)(C.default,{style:ye.header,children:[(0,g.jsx)(v.default,{onPress:()=>e.goBack(),style:ye.headerButton,children:(0,g.jsx)(I.default,{name:"arrow-back-outline",size:26,color:"#FFFFFF"})}),(0,g.jsx)(b.default,{style:ye.headerTitle,children:"Documentos"}),(0,g.jsx)(C.default,{style:{width:38}})]}),(0,g.jsxs)(C.default,{style:ye.viewTypeContainer,children:[(0,g.jsxs)(v.default,{style:[ye.viewTypeButton,"meusArquivos"===o&&ye.viewTypeButtonActive],onPress:()=>a("meusArquivos"),children:[(0,g.jsx)(I.default,{name:"folder-outline",size:18,color:"meusArquivos"===o?"#065F46":"#374151",style:{marginRight:6}}),(0,g.jsx)(b.default,{style:[ye.viewTypeText,"meusArquivos"===o&&ye.viewTypeTextActive],children:"Meus Arquivos"})]}),(0,g.jsxs)(v.default,{style:[ye.viewTypeButton,"compartilhadosComigo"===o&&ye.viewTypeButtonActive],onPress:()=>a("compartilhadosComigo"),children:[(0,g.jsx)(I.default,{name:"people-outline",size:18,color:"compartilhadosComigo"===o?"#065F46":"#374151",style:{marginRight:6}}),(0,g.jsx)(b.default,{style:[ye.viewTypeText,"compartilhadosComigo"===o&&ye.viewTypeTextActive],children:"Compartilhados"})]})]}),c&&!T.length?(0,g.jsxs)(C.default,{style:ye.fullScreenLoader,children:[(0,g.jsx)(z.default,{size:"large",color:"#1D854C"}),(0,g.jsx)(b.default,{style:ye.loadingText,children:"Carregando..."})]}):(0,g.jsx)(Q.default,{data:T,renderItem:({item:e})=>{const o=e.uploadedByUid===t?.uid,a=(n=e.fileType)?(n=n.toLowerCase()).startsWith("image/")?"image-outline":n.startsWith("video/")?"videocam-outline":n.startsWith("audio/")?"musical-notes-outline":"application/pdf"===n?"document-outline":n.includes("presentation")||n.includes("powerpoint")?"easel-outline":n.includes("spreadsheet")||n.includes("excel")?"stats-chart-outline":n.includes("word")||n.includes("document")?"document-text-outline":n.includes("zip")||n.includes("archive")?"archive-outline":"document-attach-outline":"document-text-outline";var n;return(0,g.jsxs)(v.default,{style:ye.arquivoCard,activeOpacity:.8,onPress:()=>(async(e,t)=>{if(e)try{await ue.default.canOpenURL(e)?await ue.default.openURL(e):D.default.alert("A\xe7\xe3o n\xe3o Suportada",`N\xe3o \xe9 poss\xedvel abrir "${t}".`)}catch(o){D.default.alert("Erro","Ocorreu um erro ao tentar abrir o arquivo.")}else D.default.alert("Erro","URL do arquivo n\xe3o dispon\xedvel.")})(e.fileUrl,e.fileName),children:[(0,g.jsx)(C.default,{style:ye.arquivoIconContainer,children:(0,g.jsx)(I.default,{name:a,size:28,color:"#1D854C"})}),(0,g.jsxs)(C.default,{style:ye.arquivoInfo,children:[(0,g.jsx)(b.default,{style:ye.arquivoTitle,numberOfLines:1,children:e.title}),(0,g.jsxs)(b.default,{style:ye.arquivoDetails,numberOfLines:1,children:[e.fileName," (",pe(e.fileSize||0),")"]}),(0,g.jsxs)(b.default,{style:ye.arquivoDate,children:["Por: ",e.uploadedByName||"Desconhecido"," em ",new Date(e.uploadedAt||Date.now()).toLocaleDateString("pt-BR")]}),e.tags&&e.tags.length>0&&(0,g.jsx)(w.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:ye.tagsScrollContainer,children:(0,g.jsx)(C.default,{style:ye.tagsContainer,children:e.tags.map((e=>(0,g.jsx)(C.default,{style:ye.tagChipMini,children:(0,g.jsx)(b.default,{style:ye.tagTextMini,children:e})},e)))})})]}),o&&(0,g.jsx)(C.default,{style:ye.actionIconsContainer,children:(0,g.jsx)(v.default,{onPress:()=>S(e),style:ye.actionIconTouch,children:(0,g.jsx)(I.default,{name:"ellipsis-vertical",size:22,color:"#6B7280"})})})]})},keyExtractor:e=>e.id.toString(),contentContainerStyle:ye.arquivosList,ListEmptyComponent:()=>(0,g.jsxs)(C.default,{style:ye.emptyStateContainer,children:[(0,g.jsx)(I.default,{name:"file-tray-outline",size:60,color:"#CBD5E0"}),(0,g.jsx)(b.default,{style:ye.emptyStateText,children:"meusArquivos"===o?"Voc\xea ainda n\xe3o tem arquivos.":"Nenhum arquivo compartilhado."}),"meusArquivos"===o&&(0,g.jsx)(b.default,{style:ye.emptyStateSubText,children:"Use o bot\xe3o '+' para adicionar."})]})}),(0,g.jsx)(v.default,{style:[ye.addButton,j&&ye.buttonDisabled],onPress:()=>!j&&S(),disabled:j,children:j?(0,g.jsx)(z.default,{color:"#FFFFFF"}):(0,g.jsx)(E.default,{name:"add",size:32,color:"#FFFFFF"})}),(0,g.jsx)(ge,{isVisible:h,onClose:()=>{m(!1),y(null)},onFileSaved:()=>{},existingFile:p})]})},ye=S.default.create({container:{flex:1,backgroundColor:"#F9FAFB"},header:{height:60,backgroundColor:"#1D854C",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:12,elevation:4},headerButton:{padding:10},headerTitle:{fontSize:20,color:"#FFFFFF",fontWeight:"600"},viewTypeContainer:{flexDirection:"row",justifyContent:"center",paddingVertical:12,paddingHorizontal:16,backgroundColor:"#FFFFFF",borderBottomWidth:1,borderBottomColor:"#E5E7EB"},viewTypeButton:{flexDirection:"row",alignItems:"center",paddingVertical:10,paddingHorizontal:20,borderRadius:25,marginHorizontal:8,backgroundColor:"#F3F4F6"},viewTypeButtonActive:{backgroundColor:"#D1FAE5"},viewTypeText:{fontSize:15,color:"#374151",fontWeight:"500"},viewTypeTextActive:{color:"#065F46",fontWeight:"600"},fullScreenLoader:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,fontSize:16,color:"#1D854C"},arquivosList:{paddingHorizontal:16,paddingTop:16,paddingBottom:90},arquivoCard:{backgroundColor:"#FFFFFF",borderRadius:12,paddingVertical:12,paddingHorizontal:16,marginBottom:16,flexDirection:"row",alignItems:"center",elevation:2,shadowColor:"#000000",shadowOffset:{width:0,height:1},shadowOpacity:.06,shadowRadius:4},arquivoIconContainer:{width:44,height:44,borderRadius:8,backgroundColor:"#E8F5E9",justifyContent:"center",alignItems:"center",marginRight:12},arquivoInfo:{flex:1,marginRight:8},arquivoTitle:{fontSize:16,fontWeight:"600",color:"#1F2937",marginBottom:3},arquivoDetails:{fontSize:12,color:"#6B7280",marginBottom:2},arquivoDate:{fontSize:11,color:"#9CA3AF",marginBottom:5},tagsScrollContainer:{maxHeight:28,marginTop:2},tagsContainer:{flexDirection:"row"},tagChipMini:{backgroundColor:"#E0E7FF",borderRadius:10,paddingVertical:3,paddingHorizontal:8,marginRight:5},tagTextMini:{color:"#4338CA",fontSize:10,fontWeight:"500"},actionIconsContainer:{paddingLeft:8},actionIconTouch:{padding:8},emptyStateContainer:{flex:1,alignItems:"center",justifyContent:"center",padding:20,marginTop:40},emptyStateText:{marginTop:16,fontSize:17,fontWeight:"500",color:"#6B7280",textAlign:"center"},emptyStateSubText:{marginTop:8,fontSize:14,color:"#9CA3AF",textAlign:"center",lineHeight:20},addButton:{position:"absolute",right:20,bottom:25,width:60,height:60,borderRadius:30,backgroundColor:"#1D854C",justifyContent:"center",alignItems:"center",elevation:6,shadowColor:"#052e16",shadowOffset:{width:0,height:3},shadowOpacity:.3,shadowRadius:4},buttonDisabled:{backgroundColor:"#A5D6A7"}});var je=o(62057),Ce=o(71476);const be=({label:e,options:t,selectedValue:o,onValueChange:a,disabled:r})=>{const[l,i]=(0,n.useState)(!1),s=t.find((e=>e.value===o));return(0,g.jsxs)(C.default,{style:[ve.inputField,{zIndex:l?10:1}],children:[(0,g.jsx)(b.default,{style:ve.inputLabel,children:e}),(0,g.jsxs)(v.default,{onPress:()=>!r&&i(!l),style:[ve.pickerButton,r&&ve.disabledInput],children:[(0,g.jsx)(b.default,{style:[ve.pickerButtonText,r&&ve.disabledText],children:s?s.label:"Selecione..."}),(0,g.jsx)(I.default,{name:l?"chevron-up-outline":"chevron-down-outline",size:22,color:r?"#A0AEC0":"#555"})]}),l&&!r&&(0,g.jsx)(C.default,{style:ve.pickerOptionsContainer,children:t.map((e=>(0,g.jsx)(v.default,{style:ve.pickerOption,onPress:()=>{a(e.value),i(!1)},children:(0,g.jsx)(b.default,{children:e.label})},e.value)))})]})},Fe=({isVisible:e,onClose:t,onEventSaved:o,existingEvent:a})=>{const{userData:r}=x(),[i,s]=(0,n.useState)(null),[d,c]=(0,n.useState)(""),[u,h]=(0,n.useState)(""),[m,p]=(0,n.useState)("active"),[y,j]=(0,n.useState)(new Date),[S,T]=(0,n.useState)(new Date),[B,k]=(0,n.useState)(!1),[A,E]=(0,n.useState)(!1),[P,R]=(0,n.useState)("presencial"),[W,L]=(0,n.useState)(""),[O,H]=(0,n.useState)(""),[N,V]=(0,n.useState)([]),[U,q]=(0,n.useState)({}),[M,G]=(0,n.useState)(!1),[_,J]=(0,n.useState)(!1),K=!!a,Q=K&&a?.createdBy===r?.uid,Y=M||"active"!==m,X="concluded"===m?" (Evento Conclu\xeddo)":"cancelled"===m?" (Evento Cancelado)":"";(0,n.useEffect)((()=>{if(e){if(K&&a){if(s(a.id),c(a.title||""),h(a.description||""),p(a.status||"active"),j(a.date?new Date(a.date+"T00:00:00"):new Date),a.time){const[e,t]=a.time.split(":"),o=new Date;o.setHours(parseInt(e,10)),o.setMinutes(parseInt(t,10)),T(o)}else T(new Date);R(a.isOnline?"online":"presencial"),L(a.location||"");const e={};a.attendees&&Object.entries(a.attendees).forEach((([t,o])=>{e[t]={name:o.name,avatarUrl:o.avatarUrl||null}})),q(e)}else Z();V([]),H("")}}),[e,a,K,r]);const Z=()=>{s(null),c(""),h(""),p("active"),j(new Date);const e=new Date;e.setMinutes(15*Math.ceil(e.getMinutes()/15)),T(e),R("presencial"),L(""),H(""),V([]),G(!1),r&&r.uid&&r.name?q({[r.uid]:{name:r.name,avatarUrl:r.profileImageUrl||null}}):q({})},ee=()=>k(!1),te=()=>E(!1),oe=e=>{q((t=>{const o=Object.assign({},t);return o[e.id]?delete o[e.id]:o[e.id]={name:e.name,avatarUrl:e.avatarUrl||null},o})),V((t=>t.filter((t=>t.id!==e.id)))),H("")},ae=async e=>{if(!Q||!i)return;const a="concluded"===e?"concluir":"cancelar",n="concluded"===e?"Concluir Evento":"Cancelar Evento";D.default.alert(n,`Tem certeza que deseja ${a} este evento?`,[{text:"Voltar",style:"cancel"},{text:`Sim, ${a}`,style:"cancelled"===e?"destructive":"default",onPress:async()=>{G(!0);try{await(0,l.update)((0,l.ref)(f,`events/${i}`),{status:e,updatedAt:(0,l.serverTimestamp)()}),D.default.alert("Sucesso!",`Evento marcado como ${"concluded"===e?"conclu\xeddo":"cancelado"}.`),o&&o(),t()}catch(n){D.default.alert("Erro",`N\xe3o foi poss\xedvel ${a} o evento.`)}finally{G(!1)}}}])};return(0,g.jsx)($.default,{isVisible:e,onSwipeComplete:M?null:t,swipeDirection:M?[]:["down"],onBackdropPress:M?null:t,onModalHide:Z,style:ve.modal,avoidKeyboard:!0,children:(0,g.jsxs)(C.default,{style:ve.modalContent,children:[(0,g.jsxs)(C.default,{style:ve.modalHeader,children:[(0,g.jsx)(b.default,{style:ve.modalTitle,children:K?"Editar Evento":"Novo Evento"}),(0,g.jsx)(v.default,{onPress:M?null:t,disabled:M,children:(0,g.jsx)(I.default,{name:"close-outline",size:28,color:M?"#A0AEC0":"#333"})})]}),(0,g.jsx)(w.default,{showsVerticalScrollIndicator:!1,keyboardShouldPersistTaps:"handled",children:(0,g.jsxs)(C.default,{style:ve.formContainer,children:[(0,g.jsxs)(C.default,{style:ve.inputField,children:[(0,g.jsxs)(b.default,{style:ve.inputLabel,children:["T\xedtulo do Evento *",X]}),(0,g.jsx)(F.default,{style:[ve.input,Y&&ve.disabledInput],value:d,onChangeText:c,editable:!Y,placeholder:"Ex: Reuni\xe3o Semanal",placeholderTextColor:"#A0AEC0"})]}),(0,g.jsxs)(C.default,{style:ve.inputField,children:[(0,g.jsx)(b.default,{style:ve.inputLabel,children:"Descri\xe7\xe3o"}),(0,g.jsx)(F.default,{style:[ve.input,ve.textArea,Y&&ve.disabledInput],value:u,onChangeText:h,multiline:!0,numberOfLines:3,editable:!Y,placeholder:"Detalhes, pauta da reuni\xe3o...",placeholderTextColor:"#A0AEC0"})]}),(0,g.jsxs)(C.default,{style:ve.inputField,children:[(0,g.jsx)(b.default,{style:ve.inputLabel,children:"Data e Hora *"}),(0,g.jsxs)(C.default,{style:ve.dateTimeContainer,children:[(0,g.jsxs)(v.default,{onPress:()=>k(!0),style:[ve.dateTimeInputWrapper,Y&&ve.disabledInput],disabled:Y,children:[(0,g.jsx)(I.default,{name:"calendar-outline",size:20,color:Y?"#A0AEC0":"#4A5568",style:ve.dateTimeIcon}),(0,g.jsx)(b.default,{style:[ve.dateTimeInputText,Y&&ve.disabledText],children:y.toLocaleDateString("pt-BR")})]}),(0,g.jsxs)(v.default,{onPress:()=>E(!0),style:[ve.dateTimeInputWrapper,Y&&ve.disabledInput],disabled:Y,children:[(0,g.jsx)(I.default,{name:"time-outline",size:20,color:Y?"#A0AEC0":"#4A5568",style:ve.dateTimeIcon}),(0,g.jsx)(b.default,{style:[ve.dateTimeInputText,Y&&ve.disabledText],children:S.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})]})]}),(0,g.jsx)(be,{label:"Formato do Encontro *",options:[{label:"Presencial",value:"presencial"},{label:"Online",value:"online"}],selectedValue:P,onValueChange:R,disabled:Y}),(0,g.jsxs)(C.default,{style:ve.inputField,children:[(0,g.jsx)(b.default,{style:ve.inputLabel,children:"online"===P?"Link/Plataforma *":"Local/Sala *"}),(0,g.jsx)(F.default,{style:[ve.input,Y&&ve.disabledInput],value:W,onChangeText:L,editable:!Y,placeholder:"online"===P?"Ex: Google Meet, Zoom...":"Ex: Sala de Reuni\xf5es 03",placeholderTextColor:"#A0AEC0"})]}),(0,g.jsxs)(C.default,{style:ve.inputField,children:[(0,g.jsx)(b.default,{style:ve.inputLabel,children:"Convidados"}),(0,g.jsxs)(C.default,{style:ve.guestSearchContainer,children:[(0,g.jsx)(F.default,{style:[ve.input,{flex:1,marginRight:8},Y&&ve.disabledInput],value:O,onChangeText:H,editable:!Y,placeholder:"Buscar por nome...",placeholderTextColor:"#A0AEC0"}),(0,g.jsx)(v.default,{onPress:async()=>{if(O.trim().length<3)V([]);else{J(!0);try{const e=(0,l.query)((0,l.ref)(f,"users"),(0,l.orderByChild)("name")),t=await(0,l.get)(e),o=[];t.exists()&&t.forEach((e=>{const t=e.val();t.name&&t.name.toLowerCase().includes(O.toLowerCase())&&(e.key===r.uid||U[e.key]||o.push({id:e.key,name:t.name,email:t.email,avatarUrl:t.profileImageUrl||null}))})),V(o)}catch(e){console.error("Erro ao buscar usu\xe1rios:",e),D.default.alert("Erro","Falha ao buscar usu\xe1rios.")}finally{J(!1)}}},style:[ve.searchButton,(_||Y)&&ve.disabledInput],disabled:_||Y,children:_?(0,g.jsx)(z.default,{color:"#fff",size:"small"}):(0,g.jsx)(I.default,{name:"search-outline",size:24,color:Y?"#A0AEC0":"#fff"})})]}),N.length>0&&(0,g.jsx)(C.default,{style:ve.foundUsersList,children:(0,g.jsx)(w.default,{nestedScrollEnabled:!0,style:{maxHeight:120},children:N.map((e=>(0,g.jsxs)(v.default,{style:ve.userItem,onPress:()=>oe(e),disabled:Y,children:[(0,g.jsxs)(b.default,{style:ve.userItemText,children:[e.name," (",e.email,")"]}),(0,g.jsx)(I.default,{name:"square-outline",size:22,color:"#1D854C"})]},e.id)))})}),Object.keys(U).length>0&&(0,g.jsxs)(C.default,{style:ve.selectedGuestsContainer,children:[(0,g.jsx)(b.default,{style:ve.selectedGuestsTitle,children:"Participantes:"}),(0,g.jsx)(C.default,{style:ve.chipsWrapper,children:Object.entries(U).map((([e,t])=>(0,g.jsxs)(C.default,{style:ve.selectedGuestChip,children:[(0,g.jsx)(b.default,{style:ve.selectedGuestName,children:t.name}),!(K&&e===a?.createdBy)&&!(!K&&e===r?.uid)&&(0,g.jsx)(v.default,{onPress:()=>oe(Object.assign({id:e},t)),style:{marginLeft:5},disabled:Y,children:(0,g.jsx)(I.default,{name:"close-circle-outline",size:18,color:"#D32F2F"})})]},e)))})]})]}),(0,g.jsx)(v.default,{style:[ve.confirmButton,Y&&ve.confirmButtonDisabled],onPress:async()=>{if(!d.trim())return void D.default.alert("Campo Obrigat\xf3rio","Por favor, preencha o t\xedtulo do evento.");if(!W.trim()&&"presencial"===P)return void D.default.alert("Campo Obrigat\xf3rio","Informe o local/sala.");if(!r||!r.uid)return void D.default.alert("Erro","Usu\xe1rio n\xe3o autenticado.");G(!0);const e={title:d.trim(),description:u.trim(),date:y.toISOString().split("T")[0],time:S.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),isOnline:"online"===P,location:W.trim(),attendees:U,updatedAt:(0,l.serverTimestamp)()};try{K&&i?(e.createdBy=a.createdBy,e.creatorName=a.creatorName,e.createdAt=a.createdAt,e.status=a.status||"active",await(0,l.update)((0,l.ref)(f,`events/${i}`),e),D.default.alert("Sucesso","Evento atualizado!")):(e.createdBy=r.uid,e.creatorName=r.name||"Desconhecido",e.createdAt=(0,l.serverTimestamp)(),e.status="active",await(0,l.push)((0,l.ref)(f,"events"),e),D.default.alert("Sucesso","Evento criado!")),o&&o(),t()}catch(n){console.error("Erro ao salvar evento:",n),D.default.alert("Erro",`N\xe3o foi poss\xedvel ${K?"atualizar":"criar"} o evento.`)}finally{G(!1)}},disabled:Y,children:M?(0,g.jsx)(z.default,{color:"#fff"}):(0,g.jsx)(b.default,{style:ve.confirmButtonText,children:K?"Salvar Altera\xe7\xf5es":"Criar Evento"})}),Q&&"active"===m&&(0,g.jsxs)(C.default,{style:ve.actionButtonsContainer,children:[(0,g.jsxs)(v.default,{style:[ve.actionButton,ve.concludeButton],onPress:()=>ae("concluded"),disabled:M,children:[(0,g.jsx)(I.default,{name:"checkmark-done-circle-outline",size:20,color:"#15803d"}),(0,g.jsx)(b.default,{style:[ve.actionButtonText,{color:"#15803d"}],children:"Marcar como Conclu\xeddo"})]}),(0,g.jsxs)(v.default,{style:[ve.actionButton,ve.cancelButton],onPress:()=>ae("cancelled"),disabled:M,children:[(0,g.jsx)(I.default,{name:"close-circle-outline",size:20,color:"#b91c1c"}),(0,g.jsx)(b.default,{style:[ve.actionButtonText,{color:"#b91c1c"}],children:"Cancelar Evento"})]})]})]})}),(0,g.jsx)(ne.default,{isVisible:B,mode:"date",date:y,onConfirm:e=>{j(e),ee()},onCancel:ee}),(0,g.jsx)(ne.default,{isVisible:A,mode:"time",date:S,onConfirm:e=>{T(e),te()},onCancel:te,is24Hour:!0})]})})},ve=S.default.create({modal:{justifyContent:"flex-end",margin:0},modalContent:{backgroundColor:"#FFFFFF",paddingTop:15,borderTopRightRadius:25,borderTopLeftRadius:25,maxHeight:"90%",paddingBottom:10},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBottom:15,paddingHorizontal:20,marginBottom:10},modalTitle:{fontSize:22,fontWeight:"bold",color:"#1F2937"},formContainer:{paddingHorizontal:20,paddingBottom:20},inputField:{marginBottom:20},inputLabel:{fontSize:15,color:"#4A5568",marginBottom:8,fontWeight:"500"},input:{backgroundColor:"#F7F8FC",borderRadius:10,height:52,paddingHorizontal:15,fontSize:16,color:"#2D3748",borderWidth:1,borderColor:"#E2E8F0"},disabledInput:{backgroundColor:"#E5E7EB"},disabledText:{color:"#9CA3AF"},textArea:{minHeight:80,paddingTop:12,textAlignVertical:"top"},dateTimeContainer:{flexDirection:"row",justifyContent:"space-between"},dateTimeInputWrapper:{flexDirection:"row",alignItems:"center",backgroundColor:"#F7F8FC",borderRadius:10,height:52,paddingHorizontal:12,borderWidth:1,borderColor:"#E2E8F0"},dateInput:{flex:.58,marginRight:8},timeInput:{flex:.38,marginLeft:8},dateTimeIcon:{marginRight:8},dateTimeInputText:{fontSize:16,color:"#2D3748"},confirmButton:{backgroundColor:"#1D854C",borderRadius:10,height:52,justifyContent:"center",alignItems:"center",marginTop:10,elevation:2},confirmButtonDisabled:{backgroundColor:"#A5D6A7"},confirmButtonText:{color:"#FFFFFF",fontSize:17,fontWeight:"600"},pickerButton:{backgroundColor:"#F7F8FC",borderRadius:10,height:52,paddingHorizontal:15,borderWidth:1,borderColor:"#E2E8F0",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},pickerButtonText:{fontSize:16,color:"#2D3748"},pickerOptionsContainer:{backgroundColor:"#FFFFFF",borderRadius:8,marginTop:4,borderColor:"#E2E8F0",borderWidth:1,elevation:5,zIndex:1e3,position:"absolute",width:"100%",top:80},pickerOption:{paddingVertical:12,paddingHorizontal:15,borderBottomWidth:1,borderBottomColor:"#F3F4F6"},guestSearchContainer:{flexDirection:"row",alignItems:"center",marginBottom:10},searchButton:{backgroundColor:"#1D854C",paddingHorizontal:14,borderRadius:8,justifyContent:"center",alignItems:"center",height:52},foundUsersList:{borderColor:"#E2E8F0",borderWidth:1,borderRadius:8,backgroundColor:"#fff",marginTop:8},userItem:{paddingVertical:10,paddingHorizontal:12,borderBottomWidth:1,borderBottomColor:"#F3F4F6",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},userItemText:{fontSize:15,color:"#374151"},selectedGuestsContainer:{marginTop:15},selectedGuestsTitle:{fontSize:14,fontWeight:"600",color:"#10502F",marginBottom:10},chipsWrapper:{flexDirection:"row",flexWrap:"wrap"},selectedGuestChip:{flexDirection:"row",alignItems:"center",backgroundColor:"#E0F2FE",borderRadius:16,paddingVertical:6,paddingHorizontal:12,marginRight:8,marginBottom:8},selectedGuestName:{color:"#0C4A6E",fontWeight:"500",fontSize:14},actionButtonsContainer:{marginTop:20,borderTopWidth:1,borderTopColor:"#E5E7EB",paddingTop:20},actionButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",borderRadius:10,height:50,borderWidth:1.5,marginBottom:12},actionButtonText:{marginLeft:8,fontSize:16,fontWeight:"600"},concludeButton:{borderColor:"#16a34a",backgroundColor:"#f0fdf4"},cancelButton:{borderColor:"#dc2626",backgroundColor:"#fef2f2"}});Ce.LocaleConfig.locales["pt-br"]={monthNames:["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda","Ter\xe7a","Quarta","Quinta","Sexta","S\xe1bado"],dayNamesShort:["DOM","SEG","TER","QUA","QUI","SEX","S\xc1B"],today:"Hoje"},Ce.LocaleConfig.defaultLocale="pt-br";const Se=e=>e.toISOString().split("T")[0],Te=je.default.get("window").width,we=({navigation:e,route:t})=>{const{userData:o}=x(),[a,r]=(0,n.useState)("diario"),[i,s]=(0,n.useState)(new Date),[d,c]=(0,n.useState)({}),[u,h]=(0,n.useState)(!0),[m,p]=(0,n.useState)(!1),[y,j]=(0,n.useState)("Minha Agenda"),[F,S]=(0,n.useState)(null),T=(0,n.useMemo)((()=>Se(i)),[i]),A=(0,n.useMemo)((()=>(e=>{const t=[],o=new Date(e+"T00:00:00"),a=o.getDay(),n=new Date(o);n.setDate(o.getDate()-a);const r=Ce.LocaleConfig.locales["pt-br"].dayNamesShort||["DOM","SEG","TER","QUA","QUI","SEX","S\xc1B"];for(let l=0;l<7;l++){const e=new Date(n);e.setDate(n.getDate()+l);const o=e.getDay();t.push({dateString:Se(e),dayOfMonth:e.getDate(),dayNameShort:r[o].substring(0,3)})}return t})(T)),[T]);(0,n.useEffect)((()=>{t.params?.screenTitle?j(t.params.screenTitle):j("diario"===a?new Date(T+"T00:00:00").toLocaleDateString("pt-BR",{month:"long",year:"numeric"}):"Minha Agenda")}),[t.params,T,a]),(0,n.useEffect)((()=>{if(!o||!o.uid)return h(!1),void c({});h(!0);const e=(0,l.query)((0,l.ref)(f,"events"),(0,l.orderByChild)("date")),t=(0,l.onValue)(e,(e=>{const t={};e.exists()&&e.forEach((e=>{const a=Object.assign({id:e.key},e.val());let n=!1;if((a.createdBy===o.uid||a.attendees&&a.attendees[o.uid])&&(n=!0),n){const e=a.date;t[e]||(t[e]=[]),t[e].push(a),t[e].sort(((e,t)=>(e.time||"00:00").localeCompare(t.time||"00:00")))}})),c(t),h(!1)}),(e=>{console.error("Erro ao carregar eventos:",e),D.default.alert("Erro","N\xe3o foi poss\xedvel carregar os eventos."),h(!1)}));return()=>t()}),[o]);const P=(0,n.useMemo)((()=>d[T]||[]),[d,T]),R=(0,n.useMemo)((()=>{const e={};return A.forEach((t=>{e[t.dateString]=d[t.dateString]||[]})),e}),[d,A]),W=(0,n.useMemo)((()=>{const e={};return Object.keys(d).forEach((t=>{d[t]&&d[t].length>0&&(e[t]={marked:!0,dotColor:"#1D854C"})})),e[T]?e[T]=Object.assign({},e[T],{selected:!0,selectedColor:"#1D854C"}):e[T]={selected:!0,selectedColor:"#1D854C"},e}),[d,T]),L=(e=null)=>{S(e),p(!0)},O=(e,t)=>{const o=new Date(i);if("day"===t&&o.setDate(o.getDate()+e),"week"===t&&o.setDate(o.getDate()+7*e),"month"===t){const t=o.getMonth();o.setMonth(t+e),o.getMonth()!==(t+e+12)%12&&o.setDate(0)}s(o)},H=e=>{s(new Date(e.dateString+"T00:00:00")),r("diario")},N=({item:e,cardStyle:t})=>{const o="concluded"===e.status,a="cancelled"===e.status,n=o||a;let r=e.isOnline?"#3B82F6":"#10B981";return o&&(r="#6B7280"),a&&(r="#EF4444"),(0,g.jsxs)(v.default,{style:[Be.eventCard,t,n&&Be.eventCardDisabled],activeOpacity:.7,onPress:()=>L(e),children:[(0,g.jsx)(C.default,{style:[Be.eventIndicator,{backgroundColor:r}]}),(0,g.jsxs)(C.default,{style:Be.eventInfo,children:[(0,g.jsx)(b.default,{style:[Be.eventTitle,a&&Be.eventTitleCancelled],numberOfLines:1,children:e.title}),(0,g.jsxs)(b.default,{style:Be.eventDetails,children:[(0,g.jsx)(I.default,{name:"time-outline",size:14,color:"#6B7280"})," ",e.time]}),(0,g.jsxs)(b.default,{style:Be.eventLocation,numberOfLines:1,children:[(0,g.jsx)(I.default,{name:e.isOnline?"videocam-outline":"location-outline",size:14,color:"#6B7280"})," ",e.location]})]}),o&&(0,g.jsx)(I.default,{name:"checkmark-circle",size:24,color:"#16a34a",style:{marginRight:4}}),a&&(0,g.jsx)(I.default,{name:"remove-circle",size:24,color:"#dc2626",style:{marginRight:4}}),!n&&(0,g.jsx)(I.default,{name:"chevron-forward",size:20,color:"#9CA3AF"})]})};return(0,g.jsxs)(B.default,{style:Be.container,children:[(0,g.jsx)(k.default,{backgroundColor:"#1D854C",barStyle:"light-content"}),(0,g.jsxs)(C.default,{style:Be.header,children:[(0,g.jsx)(v.default,{onPress:()=>e.goBack(),style:Be.headerButton,children:(0,g.jsx)(I.default,{name:"arrow-back-outline",size:26,color:"#FFFFFF"})}),(0,g.jsx)(b.default,{style:Be.headerTitle,children:y}),(0,g.jsx)(v.default,{onPress:()=>s(new Date),style:Be.headerButton,children:(0,g.jsx)(I.default,{name:"today-outline",size:24,color:"#FFFFFF"})})]}),(0,g.jsx)(C.default,{style:Be.viewModeSelector,children:["diario","semanal","mensal"].map((e=>(0,g.jsx)(v.default,{style:[Be.modeButton,a===e&&Be.modeButtonActive],onPress:()=>r(e),children:(0,g.jsx)(b.default,{style:[Be.modeButtonText,a===e&&Be.modeButtonTextActive],children:e.charAt(0).toUpperCase()+e.slice(1)})},e)))}),(0,g.jsx)(C.default,{style:Be.content,children:u&&!Object.keys(d).length?(0,g.jsx)(z.default,{style:{flex:1,marginTop:50},size:"large",color:"#1D854C"}):"mensal"===a?(0,g.jsx)(Ce.Calendar,{current:T,onDayPress:H,markedDates:W,onMonthChange:e=>s(new Date(e.dateString+"T00:00:00")),monthFormat:"MMMM yyyy",theme:{calendarBackground:"#FFFFFF",textSectionTitleColor:"#4A5568",selectedDayBackgroundColor:"#1D854C",selectedDayTextColor:"#ffffff",todayTextColor:"#1D854C",dayTextColor:"#1F2937",textDisabledColor:"#D1D5DB",dotColor:"#1D854C",selectedDotColor:"#ffffff",arrowColor:"#1D854C",monthTextColor:"#1D854C",textDayFontWeight:"400",textMonthFontWeight:"600",textDayHeaderFontWeight:"500",textDayFontSize:16,textMonthFontSize:18,textDayHeaderFontSize:14,"stylesheet.calendar.header":{week:{marginTop:8,flexDirection:"row",justifyContent:"space-around",borderBottomWidth:1,borderColor:"#E5E7EB",paddingBottom:10,marginBottom:8}}},style:Be.calendarView}):"semanal"===a?(0,g.jsxs)(C.default,{style:{flex:1},children:[(0,g.jsxs)(C.default,{style:Be.weekNavigation,children:[(0,g.jsx)(v.default,{onPress:()=>O(-1,"week"),style:Be.weekNavButton,children:(0,g.jsx)(I.default,{name:"chevron-back",size:26,color:"#1D854C"})}),(0,g.jsx)(b.default,{style:Be.weekNavTitle,children:`${A[0]?.dayOfMonth} ${Ce.LocaleConfig.locales["pt-br"].monthNamesShort[new Date(A[0]?.dateString+"T00:00:00").getMonth()]} - ${A[6]?.dayOfMonth} ${Ce.LocaleConfig.locales["pt-br"].monthNamesShort[new Date(A[6]?.dateString+"T00:00:00").getMonth()]}, ${new Date(A[0]?.dateString+"T00:00:00").getFullYear()}`}),(0,g.jsx)(v.default,{onPress:()=>O(1,"week"),style:Be.weekNavButton,children:(0,g.jsx)(I.default,{name:"chevron-forward",size:26,color:"#1D854C"})})]}),(0,g.jsx)(w.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:Be.weekDaysContainer,children:A.map((e=>(e=>{const t=R[e]||[],o=A.find((t=>t.dateString===e));return(0,g.jsxs)(v.default,{style:Be.weekDayColumn,onPress:()=>{s(new Date(e+"T00:00:00")),r("diario")},activeOpacity:.9,children:[(0,g.jsxs)(C.default,{style:[Be.weekDayHeader,e===T&&Be.weekDayHeaderSelected],children:[(0,g.jsx)(b.default,{style:[Be.weekDayLabelShort,e===T&&Be.weekDayLabelSelectedText],children:o?.dayNameShort}),(0,g.jsx)(b.default,{style:[Be.weekDayNumber,e===T&&Be.weekDayNumberSelected],children:o?.dayOfMonth})]}),(0,g.jsx)(w.default,{nestedScrollEnabled:!0,showsVerticalScrollIndicator:!1,contentContainerStyle:{paddingBottom:5,flexGrow:1},children:t.length>0?t.map((e=>N({item:e,cardStyle:Be.weekEventCard}))):(0,g.jsx)(C.default,{style:Be.weekEmptySlot,children:(0,g.jsx)(b.default,{style:Be.weekEmptyText,children:"-"})})})]},e)})(e.dateString)))})]}):(0,g.jsxs)(C.default,{style:{flex:1},children:[(0,g.jsxs)(C.default,{style:Be.dayNavigation,children:[(0,g.jsx)(v.default,{onPress:()=>O(-1,"day"),style:Be.dayNavButton,children:(0,g.jsx)(I.default,{name:"chevron-back-outline",size:24,color:"#333"})}),(0,g.jsx)(v.default,{onPress:()=>r("mensal"),children:(0,g.jsx)(b.default,{style:Be.dayNavTitle,children:new Date(T+"T00:00:00").toLocaleDateString("pt-BR",{weekday:"long",day:"numeric"})})}),(0,g.jsx)(v.default,{onPress:()=>O(1,"day"),style:Be.dayNavButton,children:(0,g.jsx)(I.default,{name:"chevron-forward-outline",size:24,color:"#333"})})]}),(0,g.jsx)(Q.default,{data:P,renderItem:N,keyExtractor:e=>e.id.toString(),ListEmptyComponent:()=>(0,g.jsxs)(C.default,{style:Be.emptyStateContainer,children:[(0,g.jsx)(I.default,{name:"calendar-outline",size:60,color:"#CBD5E0"}),(0,g.jsx)(b.default,{style:Be.emptyStateText,children:"Sem eventos para este dia."}),(0,g.jsx)(b.default,{style:Be.emptyStateSubText,children:"Relaxe ou adicione um novo evento!"})]}),contentContainerStyle:{flexGrow:1,paddingBottom:80}})]})}),o&&o.uid&&(0,g.jsx)(v.default,{style:Be.addButton,onPress:()=>L(),children:(0,g.jsx)(E.default,{name:"add",size:32,color:"#FFFFFF"})}),(0,g.jsx)(Fe,{isVisible:m,onClose:()=>{p(!1),S(null)},onEventSaved:()=>{},existingEvent:F})]})},Be=S.default.create({container:{flex:1,backgroundColor:"#F9FAFB"},header:{height:60,backgroundColor:"#1D854C",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:12,elevation:4},headerButton:{padding:10},headerTitle:{fontSize:20,color:"#FFFFFF",fontWeight:"600"},viewModeSelector:{flexDirection:"row",justifyContent:"space-around",paddingVertical:12,paddingHorizontal:16,backgroundColor:"#FFFFFF",borderBottomWidth:1,borderBottomColor:"#E5E7EB"},modeButton:{paddingVertical:8,paddingHorizontal:18,borderRadius:20},modeButtonActive:{backgroundColor:"#D1FAE5"},modeButtonText:{fontSize:15,color:"#374151",fontWeight:"500"},modeButtonTextActive:{color:"#065F46",fontWeight:"600"},content:{flex:1},calendarView:{marginHorizontal:16,marginTop:10,borderRadius:12},dayNavigation:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:15,paddingHorizontal:20,backgroundColor:"#FFFFFF",borderBottomWidth:1,borderBottomColor:"#E5E7EB"},dayNavButton:{padding:10},dayNavTitle:{fontSize:17,fontWeight:"600",color:"#1D854C"},weekNavigation:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:15,paddingHorizontal:16,backgroundColor:"#FFFFFF",borderBottomWidth:1,borderBottomColor:"#E5E7EB"},weekNavButton:{padding:10},weekNavTitle:{fontSize:16,fontWeight:"600",color:"#1D854C",textAlign:"center",flex:1},weekDaysContainer:{backgroundColor:"#F9FAFB",paddingVertical:8,paddingHorizontal:4},weekDayColumn:{width:Te/3.2,minHeight:200,marginHorizontal:5,backgroundColor:"#FFFFFF",borderRadius:10,elevation:2,shadowColor:"#000",shadowOpacity:.06,shadowRadius:4,paddingBottom:8,overflow:"hidden"},weekDayHeader:{paddingVertical:12,alignItems:"center",borderBottomWidth:1,borderBottomColor:"#F3F4F6",backgroundColor:"#F9FAFB"},weekDayHeaderSelected:{backgroundColor:"#1D854C",borderTopLeftRadius:10,borderTopRightRadius:10},weekDayLabelShort:{fontSize:13,color:"#6B7280",fontWeight:"500",textTransform:"uppercase"},weekDayNumber:{fontSize:18,color:"#1F2937",fontWeight:"600",marginTop:4},weekDayNumberSelected:{color:"#FFFFFF"},weekDayLabelSelectedText:{color:"#FFFFFF"},weekEventCard:{marginVertical:6,marginHorizontal:8,paddingVertical:10,paddingHorizontal:10},weekEmptySlot:{flex:1,alignItems:"center",justifyContent:"center",padding:15,minHeight:60},weekEmptyText:{color:"#9CA3AF",fontSize:13,fontStyle:"italic"},eventCard:{backgroundColor:"#FFFFFF",borderRadius:10,paddingVertical:12,paddingHorizontal:15,marginHorizontal:16,marginBottom:14,flexDirection:"row",alignItems:"center",elevation:2,shadowColor:"#000000",shadowOffset:{width:0,height:1},shadowOpacity:.06,shadowRadius:4},eventCardDisabled:{backgroundColor:"#F9FAFB",opacity:.8},eventIndicator:{width:6,height:45,borderRadius:3,marginRight:15},eventInfo:{flex:1,marginRight:8},eventTitle:{fontSize:16,fontWeight:"600",color:"#1F2937",marginBottom:5},eventTitleCancelled:{textDecorationLine:"line-through",color:"#9CA3AF"},eventDetails:{fontSize:13,color:"#4B5563",marginBottom:3,flexDirection:"row",alignItems:"center"},eventLocation:{fontSize:13,color:"#6B7280",flexDirection:"row",alignItems:"center"},emptyStateContainer:{flex:1,alignItems:"center",justifyContent:"center",padding:20,marginTop:30},emptyStateText:{marginTop:16,fontSize:17,fontWeight:"500",color:"#6B7280",textAlign:"center"},emptyStateSubText:{marginTop:8,fontSize:14,color:"#9CA3AF",textAlign:"center",lineHeight:20},addButton:{position:"absolute",right:20,bottom:25,width:60,height:60,borderRadius:30,backgroundColor:"#1D854C",justifyContent:"center",alignItems:"center",elevation:6,shadowColor:"#052e16",shadowOffset:{width:0,height:3},shadowOpacity:.3,shadowRadius:4}}),De=(0,j.createNativeStackNavigator)(),ze=(0,j.createNativeStackNavigator)(),ke=()=>(0,g.jsxs)(De.Navigator,{screenOptions:{headerShown:!1},children:[(0,g.jsx)(De.Screen,{name:"Login",component:P}),(0,g.jsx)(De.Screen,{name:"Register",component:O}),(0,g.jsx)(De.Screen,{name:"Recover",component:N})]}),Ae=()=>(0,g.jsxs)(ze.Navigator,{initialRouteName:"Home",screenOptions:{headerShown:!1},children:[(0,g.jsx)(ze.Screen,{name:"Home",component:q}),(0,g.jsx)(ze.Screen,{name:"Profile",component:J}),(0,g.jsx)(ze.Screen,{name:"Notas",component:oe}),(0,g.jsx)(ze.Screen,{name:"Tarefas",component:de}),(0,g.jsx)(ze.Screen,{name:"Arquivos",component:xe}),(0,g.jsx)(ze.Screen,{name:"Agenda",component:we})]}),Ee=S.default.create({loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#FFFFFF"},loadingText:{marginTop:10,fontSize:16,color:"#1D854C"}}),Ie=()=>{const{user:e,userData:t,isLoadingAuth:o}=x();return o?(0,g.jsxs)(C.default,{style:Ee.loadingContainer,children:[(0,g.jsx)(k.default,{backgroundColor:"#1D854C",barStyle:"light-content"}),(0,g.jsx)(z.default,{size:"large",color:"#1D854C"}),(0,g.jsx)(b.default,{style:Ee.loadingText,children:"Carregando Sess\xe3o..."})]}):(0,g.jsx)(y.NavigationContainer,{children:e?(0,g.jsx)(Ae,{}):(0,g.jsx)(ke,{})})};(0,a.default)((function(){return(0,g.jsx)(p,{children:(0,g.jsx)(Ie,{})})}))},67847:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/vert_logo.cd43385f9a6bdb37ebfe.png"}},t={};function o(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=e,(()=>{var e=[];o.O=(t,a,n,r)=>{if(!a){var l=1/0;for(c=0;c<e.length;c++){for(var[a,n,r]=e[c],i=!0,s=0;s<a.length;s++)(!1&r||l>=r)&&Object.keys(o.O).every((e=>o.O[e](a[s])))?a.splice(s--,1):(i=!1,r<l&&(l=r));if(i){e.splice(c--,1);var d=n();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,n,r]}})(),o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.p="/",(()=>{var e={792:0};o.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,[l,i,s]=a,d=0;if(l.some((t=>0!==e[t]))){for(n in i)o.o(i,n)&&(o.m[n]=i[n]);if(s)var c=s(o)}for(t&&t(a);d<l.length;d++)r=l[d],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(c)},a=self.webpackChunkweb=self.webpackChunkweb||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=o.O(void 0,[261],(()=>o(64192)));a=o.O(a)})();
//# sourceMappingURL=main.7ae09db4.js.map